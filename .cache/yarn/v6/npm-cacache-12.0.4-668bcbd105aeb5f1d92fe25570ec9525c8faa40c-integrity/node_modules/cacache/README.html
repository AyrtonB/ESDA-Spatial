
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>cacache &#8212; Spatial Analysis for Energy</title>
    
  <link rel="stylesheet" href="../../../../../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../../../../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../../../../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../../_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../../../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../../../../../" src="../../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../../_static/jquery.js"></script>
    <script src="../../../../../../_static/underscore.js"></script>
    <script src="../../../../../../_static/doctools.js"></script>
    <script src="../../../../../../_static/language_data.js"></script>
    <script src="../../../../../../_static/togglebutton.js"></script>
    <script src="../../../../../../_static/clipboard.min.js"></script>
    <script src="../../../../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../../../../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../../../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../../../../index.html">
  
  <img src="../../../../../../_static/logo.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Spatial Analysis for Energy</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../md/Intro.html">
   UCL Energy Systems &amp; Data Analytics - Spatial Module
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../tutorials/03-Working-with-Vector-Data.html">
   Working with Vector Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../tutorials/04-Working-with-Raster-Data.html">
   Working with Raster Data
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Extensions
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../extensions/01-Mapping-with-ggplot.html">
   Mapping with ggplot
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  About
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../md/Setup.html">
   Set-Up Instructions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../md/Jupyter-Anaconda.html">
   What is Jupyter/Anaconda?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../md/ESDA%20Course.html">
   ESDA Course
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../../../../_sources/.cache/yarn/v6/npm-cacache-12.0.4-668bcbd105aeb5f1d92fe25570ec9525c8faa40c-integrity/node_modules/cacache/README.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install">
   Install
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example">
     Example
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#features">
     Features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#contributing">
     Contributing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#api">
     API
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-localized-api-a-using-localized-apis">
       <a name="localized-api">
       </a>
       Using localized APIs
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-ls-a-cacache-ls-cache-promise-object">
       <a name="ls">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         cacache.ls(cache)
        </span>
        <span class="pre">
         -&gt;
        </span>
        <span class="pre">
         Promise&lt;Object&gt;
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id1">
         Example
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-ls-stream-a-cacache-ls-stream-cache-readable">
       <a name="ls-stream">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         cacache.ls.stream(cache)
        </span>
        <span class="pre">
         -&gt;
        </span>
        <span class="pre">
         Readable
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id2">
         Example
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-get-data-a-cacache-get-cache-key-opts-promise-data-metadata-integrity">
       <a name="get-data">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         cacache.get(cache,
        </span>
        <span class="pre">
         key,
        </span>
        <span class="pre">
         [opts])
        </span>
        <span class="pre">
         -&gt;
        </span>
        <span class="pre">
         Promise({data,
        </span>
        <span class="pre">
         metadata,
        </span>
        <span class="pre">
         integrity})
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#note">
         Note
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id3">
         Example
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-get-stream-a-cacache-get-stream-cache-key-opts-readable">
       <a name="get-stream">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         cacache.get.stream(cache,
        </span>
        <span class="pre">
         key,
        </span>
        <span class="pre">
         [opts])
        </span>
        <span class="pre">
         -&gt;
        </span>
        <span class="pre">
         Readable
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id4">
         Example
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-get-info-a-cacache-get-info-cache-key-promise">
       <a name="get-info">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         cacache.get.info(cache,
        </span>
        <span class="pre">
         key)
        </span>
        <span class="pre">
         -&gt;
        </span>
        <span class="pre">
         Promise
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#fields">
         Fields
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id5">
         Example
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-get-hascontent-a-cacache-get-hascontent-cache-integrity-promise">
       <a name="get-hasContent">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         cacache.get.hasContent(cache,
        </span>
        <span class="pre">
         integrity)
        </span>
        <span class="pre">
         -&gt;
        </span>
        <span class="pre">
         Promise
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id6">
         Example
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-put-data-a-cacache-put-cache-key-data-opts-promise">
       <a name="put-data">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         cacache.put(cache,
        </span>
        <span class="pre">
         key,
        </span>
        <span class="pre">
         data,
        </span>
        <span class="pre">
         [opts])
        </span>
        <span class="pre">
         -&gt;
        </span>
        <span class="pre">
         Promise
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id7">
         Example
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-put-stream-a-cacache-put-stream-cache-key-opts-writable">
       <a name="put-stream">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         cacache.put.stream(cache,
        </span>
        <span class="pre">
         key,
        </span>
        <span class="pre">
         [opts])
        </span>
        <span class="pre">
         -&gt;
        </span>
        <span class="pre">
         Writable
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id8">
         Example
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-put-options-a-cacache-put-options">
       <a name="put-options">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         cacache.put
        </span>
        <span class="pre">
         options
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#opts-metadata">
         <code class="docutils literal notranslate">
          <span class="pre">
           opts.metadata
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#opts-size">
         <code class="docutils literal notranslate">
          <span class="pre">
           opts.size
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#opts-integrity">
         <code class="docutils literal notranslate">
          <span class="pre">
           opts.integrity
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#opts-algorithms">
         <code class="docutils literal notranslate">
          <span class="pre">
           opts.algorithms
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#opts-memoize">
         <code class="docutils literal notranslate">
          <span class="pre">
           opts.memoize
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-rm-all-a-cacache-rm-all-cache-promise">
       <a name="rm-all">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         cacache.rm.all(cache)
        </span>
        <span class="pre">
         -&gt;
        </span>
        <span class="pre">
         Promise
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id9">
         Example
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-rm-entry-a-cacache-rm-entry-cache-key-promise">
       <a name="rm-entry">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         cacache.rm.entry(cache,
        </span>
        <span class="pre">
         key)
        </span>
        <span class="pre">
         -&gt;
        </span>
        <span class="pre">
         Promise
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id10">
         Example
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-rm-content-a-cacache-rm-content-cache-integrity-promise">
       <a name="rm-content">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         cacache.rm.content(cache,
        </span>
        <span class="pre">
         integrity)
        </span>
        <span class="pre">
         -&gt;
        </span>
        <span class="pre">
         Promise
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id11">
         Example
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-set-locale-a-cacache-setlocale-locale">
       <a name="set-locale">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         cacache.setLocale(locale)
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-clear-memoized-a-cacache-clearmemoized">
       <a name="clear-memoized">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         cacache.clearMemoized()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-tmp-mkdir-a-tmp-mkdir-cache-opts-promise-path">
       <a name="tmp-mkdir">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         tmp.mkdir(cache,
        </span>
        <span class="pre">
         opts)
        </span>
        <span class="pre">
         -&gt;
        </span>
        <span class="pre">
         Promise&lt;Path&gt;
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id12">
         Example
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-tmp-fix-a-tmp-fix-cache-promise">
       <a name="tmp-fix">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         tmp.fix(cache)
        </span>
        <span class="pre">
         -&gt;
        </span>
        <span class="pre">
         Promise
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id13">
         Example
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-with-tmp-a-tmp-withtmp-cache-opts-cb-promise">
       <a name="with-tmp">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         tmp.withTmp(cache,
        </span>
        <span class="pre">
         opts,
        </span>
        <span class="pre">
         cb)
        </span>
        <span class="pre">
         -&gt;
        </span>
        <span class="pre">
         Promise
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id14">
         Example
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-integrity-a-subresource-integrity-digests">
       <a name="integrity">
       </a>
       Subresource Integrity Digests
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#generating-digests-yourself">
         Generating Digests Yourself
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-verify-a-cacache-verify-cache-opts-promise">
       <a name="verify">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         cacache.verify(cache,
        </span>
        <span class="pre">
         opts)
        </span>
        <span class="pre">
         -&gt;
        </span>
        <span class="pre">
         Promise
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#options">
         Options
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id15">
         Example
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-name-verify-last-run-a-cacache-verify-lastrun-cache-promise">
       <a name="verify-last-run">
       </a>
       <code class="docutils literal notranslate">
        <span class="pre">
         &gt;
        </span>
        <span class="pre">
         cacache.verify.lastRun(cache)
        </span>
        <span class="pre">
         -&gt;
        </span>
        <span class="pre">
         Promise
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id16">
         Example
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="cacache-npm-version-license-travis-appveyor-coverage-status">
<h1>cacache <a class="reference external" href="https://npm.im/cacache"><img alt="npm version" src="https://img.shields.io/npm/v/cacache.svg" /></a> <a class="reference external" href="https://npm.im/cacache"><img alt="license" src="https://img.shields.io/npm/l/cacache.svg" /></a> <a class="reference external" href="https://travis-ci.org/npm/cacache"><img alt="Travis" src="https://img.shields.io/travis/npm/cacache.svg" /></a> <a class="reference external" href="https://ci.appveyor.com/project/npm/cacache"><img alt="AppVeyor" src="https://ci.appveyor.com/api/projects/status/github/npm/cacache?svg=true" /></a> <a class="reference external" href="https://coveralls.io/github/npm/cacache?branch=latest"><img alt="Coverage Status" src="https://coveralls.io/repos/github/npm/cacache/badge.svg?branch=latest" /></a><a class="headerlink" href="#cacache-npm-version-license-travis-appveyor-coverage-status" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://github.com/npm/cacache"><code class="docutils literal notranslate"><span class="pre">cacache</span></code></a> is a Node.js library for managing
local key and content address caches. It’s really fast, really good at
concurrency, and it will never give you corrupted data, even if cache files
get corrupted or manipulated.</p>
<p>On systems that support user and group settings on files, cacache will
match the <code class="docutils literal notranslate"><span class="pre">uid</span></code> and <code class="docutils literal notranslate"><span class="pre">gid</span></code> values to the folder where the cache lives, even
when running as <code class="docutils literal notranslate"><span class="pre">root</span></code>.</p>
<p>It was written to be used as <a class="reference external" href="https://npm.im">npm</a>’s local cache, but can
just as easily be used on its own.</p>
<p><em>Translations: <a class="reference internal" href="README.es.html"><span class="doc std std-doc">español</span></a></em></p>
<div class="section" id="install">
<h2>Install<a class="headerlink" href="#install" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">npm</span> <span class="pre">install</span> <span class="pre">--save</span> <span class="pre">cacache</span></code></p>
</div>
<div class="section" id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#example">Example</a></p></li>
<li><p><a class="reference external" href="#features">Features</a></p></li>
<li><p><a class="reference external" href="#contributing">Contributing</a></p></li>
<li><p><a class="reference external" href="#api">API</a></p>
<ul>
<li><p><a class="reference external" href="#localized-api">Using localized APIs</a></p></li>
<li><p>Reading</p>
<ul>
<li><p><a class="reference external" href="#ls"><code class="docutils literal notranslate"><span class="pre">ls</span></code></a></p></li>
<li><p><a class="reference external" href="#ls-stream"><code class="docutils literal notranslate"><span class="pre">ls.stream</span></code></a></p></li>
<li><p><a class="reference external" href="#get-data"><code class="docutils literal notranslate"><span class="pre">get</span></code></a></p></li>
<li><p><a class="reference external" href="#get-stream"><code class="docutils literal notranslate"><span class="pre">get.stream</span></code></a></p></li>
<li><p><a class="reference external" href="#get-info"><code class="docutils literal notranslate"><span class="pre">get.info</span></code></a></p></li>
<li><p><a class="reference external" href="#get-hasContent"><code class="docutils literal notranslate"><span class="pre">get.hasContent</span></code></a></p></li>
</ul>
</li>
<li><p>Writing</p>
<ul>
<li><p><a class="reference external" href="#put-data"><code class="docutils literal notranslate"><span class="pre">put</span></code></a></p></li>
<li><p><a class="reference external" href="#put-stream"><code class="docutils literal notranslate"><span class="pre">put.stream</span></code></a></p></li>
<li><p><a class="reference external" href="#put-options"><code class="docutils literal notranslate"><span class="pre">put*</span></code> opts</a></p></li>
<li><p><a class="reference external" href="#rm-all"><code class="docutils literal notranslate"><span class="pre">rm.all</span></code></a></p></li>
<li><p><a class="reference external" href="#rm-entry"><code class="docutils literal notranslate"><span class="pre">rm.entry</span></code></a></p></li>
<li><p><a class="reference external" href="#rm-content"><code class="docutils literal notranslate"><span class="pre">rm.content</span></code></a></p></li>
</ul>
</li>
<li><p>Utilities</p>
<ul>
<li><p><a class="reference external" href="#set-locale"><code class="docutils literal notranslate"><span class="pre">setLocale</span></code></a></p></li>
<li><p><a class="reference external" href="#clear-memoized"><code class="docutils literal notranslate"><span class="pre">clearMemoized</span></code></a></p></li>
<li><p><a class="reference external" href="#tmp-mkdir"><code class="docutils literal notranslate"><span class="pre">tmp.mkdir</span></code></a></p></li>
<li><p><a class="reference external" href="#with-tmp"><code class="docutils literal notranslate"><span class="pre">tmp.withTmp</span></code></a></p></li>
</ul>
</li>
<li><p>Integrity</p>
<ul>
<li><p><a class="reference external" href="#integrity">Subresource Integrity</a></p></li>
<li><p><a class="reference external" href="#verify"><code class="docutils literal notranslate"><span class="pre">verify</span></code></a></p></li>
<li><p><a class="reference external" href="#verify-last-run"><code class="docutils literal notranslate"><span class="pre">verify.lastRun</span></code></a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">cacache</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;cacache/en&#39;</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">)</span>

<span class="kr">const</span> <span class="nx">tarball</span> <span class="o">=</span> <span class="s1">&#39;/path/to/mytar.tgz&#39;</span>
<span class="kr">const</span> <span class="nx">cachePath</span> <span class="o">=</span> <span class="s1">&#39;/tmp/my-toy-cache&#39;</span>
<span class="kr">const</span> <span class="nx">key</span> <span class="o">=</span> <span class="s1">&#39;my-unique-key-1234&#39;</span>

<span class="c1">// Cache it! Use `cachePath` as the root of the content cache</span>
<span class="nx">cacache</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="nx">cachePath</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="s1">&#39;10293801983029384&#39;</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">integrity</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Saved content to </span><span class="si">${</span><span class="nx">cachePath</span><span class="si">}</span><span class="sb">.`</span><span class="p">)</span>
<span class="p">})</span>

<span class="kr">const</span> <span class="nx">destination</span> <span class="o">=</span> <span class="s1">&#39;/tmp/mytar.tgz&#39;</span>

<span class="c1">// Copy the contents out of the cache and into their destination!</span>
<span class="c1">// But this time, use stream instead!</span>
<span class="nx">cacache</span><span class="p">.</span><span class="nx">get</span><span class="p">.</span><span class="nx">stream</span><span class="p">(</span>
  <span class="nx">cachePath</span><span class="p">,</span> <span class="nx">key</span>
<span class="p">).</span><span class="nx">pipe</span><span class="p">(</span>
  <span class="nx">fs</span><span class="p">.</span><span class="nx">createWriteStream</span><span class="p">(</span><span class="nx">destination</span><span class="p">)</span>
<span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;finish&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;done extracting!&#39;</span><span class="p">)</span>
<span class="p">})</span>

<span class="c1">// The same thing, but skip the key index.</span>
<span class="nx">cacache</span><span class="p">.</span><span class="nx">get</span><span class="p">.</span><span class="nx">byDigest</span><span class="p">(</span><span class="nx">cachePath</span><span class="p">,</span> <span class="nx">integrityHash</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">fs</span><span class="p">.</span><span class="nx">writeFile</span><span class="p">(</span><span class="nx">destination</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;tarball data fetched based on its sha512sum and written out!&#39;</span><span class="p">)</span>
  <span class="p">})</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="features">
<h3>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Extraction by key or by content address (shasum, etc)</p></li>
<li><p><a class="reference external" href="#integrity">Subresource Integrity</a> web standard support</p></li>
<li><p>Multi-hash support - safely host sha1, sha512, etc, in a single cache</p></li>
<li><p>Automatic content deduplication</p></li>
<li><p>Fault tolerance (immune to corruption, partial writes, process races, etc)</p></li>
<li><p>Consistency guarantees on read and write (full data verification)</p></li>
<li><p>Lockless, high-concurrency cache access</p></li>
<li><p>Streaming support</p></li>
<li><p>Promise support</p></li>
<li><p>Pretty darn fast – sub-millisecond reads and writes including verification</p></li>
<li><p>Arbitrary metadata storage</p></li>
<li><p>Garbage collection and additional offline verification</p></li>
<li><p>Thorough test coverage</p></li>
<li><p>There’s probably a bloom filter in there somewhere. Those are cool, right? 🤔</p></li>
</ul>
</div>
<div class="section" id="contributing">
<h3>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h3>
<p>The cacache team enthusiastically welcomes contributions and project participation! There’s a bunch of things you can do if you want to contribute! The <span class="xref myst">Contributor Guide</span> has all the information you need for everything from reporting bugs to contributing entire new features. Please don’t hesitate to jump in if you’d like to, or even ask us questions if something isn’t clear.</p>
<p>All participants and maintainers in this project are expected to follow <span class="xref myst">Code of Conduct</span>, and just generally be excellent to each other.</p>
<p>Please refer to the <a class="reference internal" href="CHANGELOG.html"><span class="doc std std-doc">Changelog</span></a> for project history details, too.</p>
<p>Happy hacking!</p>
</div>
<div class="section" id="api">
<h3>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h3>
<div class="section" id="a-name-localized-api-a-using-localized-apis">
<h4><a name="localized-api"></a> Using localized APIs<a class="headerlink" href="#a-name-localized-api-a-using-localized-apis" title="Permalink to this headline">¶</a></h4>
<p>cacache includes a complete API in English, with the same features as other
translations. To use the English API as documented in this README, use
<code class="docutils literal notranslate"><span class="pre">require('cacache/en')</span></code>. This is also currently the default if you do
<code class="docutils literal notranslate"><span class="pre">require('cacache')</span></code>, but may change in the future.</p>
<p>cacache also supports other languages! You can find the list of currently
supported ones by looking in <code class="docutils literal notranslate"><span class="pre">./locales</span></code> in the source directory. You can use
the API in that language with <code class="docutils literal notranslate"><span class="pre">require('cacache/&lt;lang&gt;')</span></code>.</p>
<p>Want to add support for a new language? Please go ahead! You should be able to
copy <code class="docutils literal notranslate"><span class="pre">./locales/en.js</span></code> and <code class="docutils literal notranslate"><span class="pre">./locales/en.json</span></code> and fill them in. Translating the
<code class="docutils literal notranslate"><span class="pre">README.md</span></code> is a bit more work, but also appreciated if you get around to it. 👍🏼</p>
</div>
<div class="section" id="a-name-ls-a-cacache-ls-cache-promise-object">
<h4><a name="ls"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">cacache.ls(cache)</span> <span class="pre">-&gt;</span> <span class="pre">Promise&lt;Object&gt;</span></code><a class="headerlink" href="#a-name-ls-a-cacache-ls-cache-promise-object" title="Permalink to this headline">¶</a></h4>
<p>Lists info for all entries currently in the cache as a single large object. Each
entry in the object will be keyed by the unique index key, with corresponding
<a class="reference external" href="#get-info"><code class="docutils literal notranslate"><span class="pre">get.info</span></code></a> objects as the values.</p>
<div class="section" id="id1">
<h5>Example<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">cacache</span><span class="p">.</span><span class="nx">ls</span><span class="p">(</span><span class="nx">cachePath</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">)</span>
<span class="c1">// Output</span>
<span class="p">{</span>
  <span class="s1">&#39;my-thing&#39;</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">key</span><span class="o">:</span> <span class="s1">&#39;my-thing&#39;</span><span class="p">,</span>
    <span class="nx">integrity</span><span class="o">:</span> <span class="s1">&#39;sha512-BaSe64/EnCoDED+HAsh==&#39;</span>
    <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;.testcache/content/deadbeef&#39;</span><span class="p">,</span> <span class="c1">// joined with `cachePath`</span>
    <span class="nx">time</span><span class="o">:</span> <span class="mf">12345698490</span><span class="p">,</span>
    <span class="nx">size</span><span class="o">:</span> <span class="mf">4023948</span><span class="p">,</span>
    <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;blah&#39;</span><span class="p">,</span>
      <span class="nx">version</span><span class="o">:</span> <span class="s1">&#39;1.2.3&#39;</span><span class="p">,</span>
      <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;this was once a package but now it is my-thing&#39;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s1">&#39;other-thing&#39;</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">key</span><span class="o">:</span> <span class="s1">&#39;other-thing&#39;</span><span class="p">,</span>
    <span class="nx">integrity</span><span class="o">:</span> <span class="s1">&#39;sha1-ANothER+hasH=&#39;</span><span class="p">,</span>
    <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;.testcache/content/bada55&#39;</span><span class="p">,</span>
    <span class="nx">time</span><span class="o">:</span> <span class="mf">11992309289</span><span class="p">,</span>
    <span class="nx">size</span><span class="o">:</span> <span class="mf">111112</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-name-ls-stream-a-cacache-ls-stream-cache-readable">
<h4><a name="ls-stream"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">cacache.ls.stream(cache)</span> <span class="pre">-&gt;</span> <span class="pre">Readable</span></code><a class="headerlink" href="#a-name-ls-stream-a-cacache-ls-stream-cache-readable" title="Permalink to this headline">¶</a></h4>
<p>Lists info for all entries currently in the cache as a single large object.</p>
<p>This works just like <a class="reference external" href="#ls"><code class="docutils literal notranslate"><span class="pre">ls</span></code></a>, except <a class="reference external" href="#get-info"><code class="docutils literal notranslate"><span class="pre">get.info</span></code></a> entries are
returned as <code class="docutils literal notranslate"><span class="pre">'data'</span></code> events on the returned stream.</p>
<div class="section" id="id2">
<h5>Example<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">cacache</span><span class="p">.</span><span class="nx">ls</span><span class="p">.</span><span class="nx">stream</span><span class="p">(</span><span class="nx">cachePath</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">)</span>
<span class="c1">// Output</span>
<span class="p">{</span>
  <span class="nx">key</span><span class="o">:</span> <span class="s1">&#39;my-thing&#39;</span><span class="p">,</span>
  <span class="nx">integrity</span><span class="o">:</span> <span class="s1">&#39;sha512-BaSe64HaSh&#39;</span><span class="p">,</span>
  <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;.testcache/content/deadbeef&#39;</span><span class="p">,</span> <span class="c1">// joined with `cachePath`</span>
  <span class="nx">time</span><span class="o">:</span> <span class="mf">12345698490</span><span class="p">,</span>
  <span class="nx">size</span><span class="o">:</span> <span class="mf">13423</span><span class="p">,</span>
  <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;blah&#39;</span><span class="p">,</span>
    <span class="nx">version</span><span class="o">:</span> <span class="s1">&#39;1.2.3&#39;</span><span class="p">,</span>
    <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;this was once a package but now it is my-thing&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="p">{</span>
  <span class="nx">key</span><span class="o">:</span> <span class="s1">&#39;other-thing&#39;</span><span class="p">,</span>
  <span class="nx">integrity</span><span class="o">:</span> <span class="s1">&#39;whirlpool-WoWSoMuchSupport&#39;</span><span class="p">,</span>
  <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;.testcache/content/bada55&#39;</span><span class="p">,</span>
  <span class="nx">time</span><span class="o">:</span> <span class="mf">11992309289</span><span class="p">,</span>
  <span class="nx">size</span><span class="o">:</span> <span class="mf">498023984029</span>
<span class="p">}</span>

<span class="p">{</span>
  <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-name-get-data-a-cacache-get-cache-key-opts-promise-data-metadata-integrity">
<h4><a name="get-data"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">cacache.get(cache,</span> <span class="pre">key,</span> <span class="pre">[opts])</span> <span class="pre">-&gt;</span> <span class="pre">Promise({data,</span> <span class="pre">metadata,</span> <span class="pre">integrity})</span></code><a class="headerlink" href="#a-name-get-data-a-cacache-get-cache-key-opts-promise-data-metadata-integrity" title="Permalink to this headline">¶</a></h4>
<p>Returns an object with the cached data, digest, and metadata identified by
<code class="docutils literal notranslate"><span class="pre">key</span></code>. The <code class="docutils literal notranslate"><span class="pre">data</span></code> property of this object will be a <code class="docutils literal notranslate"><span class="pre">Buffer</span></code> instance that
presumably holds some data that means something to you. I’m sure you know what
to do with it! cacache just won’t care.</p>
<p><code class="docutils literal notranslate"><span class="pre">integrity</span></code> is a <a class="reference external" href="#integrity">Subresource
Integrity</a>
string. That is, a string that can be used to verify <code class="docutils literal notranslate"><span class="pre">data</span></code>, which looks like
<code class="docutils literal notranslate"><span class="pre">&lt;hash-algorithm&gt;-&lt;base64-integrity-hash&gt;</span></code>.</p>
<p>If there is no content identified by <code class="docutils literal notranslate"><span class="pre">key</span></code>, or if the locally-stored data does
not pass the validity checksum, the promise will be rejected.</p>
<p>A sub-function, <code class="docutils literal notranslate"><span class="pre">get.byDigest</span></code> may be used for identical behavior, except lookup
will happen by integrity hash, bypassing the index entirely. This version of the
function <em>only</em> returns <code class="docutils literal notranslate"><span class="pre">data</span></code> itself, without any wrapper.</p>
<div class="section" id="note">
<h5>Note<a class="headerlink" href="#note" title="Permalink to this headline">¶</a></h5>
<p>This function loads the entire cache entry into memory before returning it. If
you’re dealing with Very Large data, consider using <a class="reference external" href="#get-stream"><code class="docutils literal notranslate"><span class="pre">get.stream</span></code></a>
instead.</p>
</div>
<div class="section" id="id3">
<h5>Example<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span>// Look up by key
cache.get(cachePath, &#39;my-thing&#39;).then(console.log)
// Output:
{
  metadata: {
    thingName: &#39;my&#39;
  },
  integrity: &#39;sha512-BaSe64HaSh&#39;,
  data: Buffer#&lt;deadbeef&gt;,
  size: 9320
}

// Look up by digest
cache.get.byDigest(cachePath, &#39;sha512-BaSe64HaSh&#39;).then(console.log)
// Output:
Buffer#&lt;deadbeef&gt;
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-name-get-stream-a-cacache-get-stream-cache-key-opts-readable">
<h4><a name="get-stream"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">cacache.get.stream(cache,</span> <span class="pre">key,</span> <span class="pre">[opts])</span> <span class="pre">-&gt;</span> <span class="pre">Readable</span></code><a class="headerlink" href="#a-name-get-stream-a-cacache-get-stream-cache-key-opts-readable" title="Permalink to this headline">¶</a></h4>
<p>Returns a <a class="reference external" href="https://nodejs.org/api/stream.html#stream_readable_streams">Readable Stream</a> of the cached data identified by <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
<p>If there is no content identified by <code class="docutils literal notranslate"><span class="pre">key</span></code>, or if the locally-stored data does
not pass the validity checksum, an error will be emitted.</p>
<p><code class="docutils literal notranslate"><span class="pre">metadata</span></code> and <code class="docutils literal notranslate"><span class="pre">integrity</span></code> events will be emitted before the stream closes, if
you need to collect that extra data about the cached entry.</p>
<p>A sub-function, <code class="docutils literal notranslate"><span class="pre">get.stream.byDigest</span></code> may be used for identical behavior,
except lookup will happen by integrity hash, bypassing the index entirely. This
version does not emit the <code class="docutils literal notranslate"><span class="pre">metadata</span></code> and <code class="docutils literal notranslate"><span class="pre">integrity</span></code> events at all.</p>
<div class="section" id="id4">
<h5>Example<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Look up by key</span>
<span class="nx">cache</span><span class="p">.</span><span class="nx">get</span><span class="p">.</span><span class="nx">stream</span><span class="p">(</span>
  <span class="nx">cachePath</span><span class="p">,</span> <span class="s1">&#39;my-thing&#39;</span>
<span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;metadata&#39;</span><span class="p">,</span> <span class="nx">metadata</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;metadata:&#39;</span><span class="p">,</span> <span class="nx">metadata</span><span class="p">)</span>
<span class="p">}).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;integrity&#39;</span><span class="p">,</span> <span class="nx">integrity</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;integrity:&#39;</span><span class="p">,</span> <span class="nx">integrity</span><span class="p">)</span>
<span class="p">}).</span><span class="nx">pipe</span><span class="p">(</span>
  <span class="nx">fs</span><span class="p">.</span><span class="nx">createWriteStream</span><span class="p">(</span><span class="s1">&#39;./x.tgz&#39;</span><span class="p">)</span>
<span class="p">)</span>
<span class="c1">// Outputs:</span>
<span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>
<span class="nx">integrity</span><span class="o">:</span> <span class="s1">&#39;sha512-SoMeDIGest+64==&#39;</span>

<span class="c1">// Look up by digest</span>
<span class="nx">cache</span><span class="p">.</span><span class="nx">get</span><span class="p">.</span><span class="nx">stream</span><span class="p">.</span><span class="nx">byDigest</span><span class="p">(</span>
  <span class="nx">cachePath</span><span class="p">,</span> <span class="s1">&#39;sha512-SoMeDIGest+64==&#39;</span>
<span class="p">).</span><span class="nx">pipe</span><span class="p">(</span>
  <span class="nx">fs</span><span class="p">.</span><span class="nx">createWriteStream</span><span class="p">(</span><span class="s1">&#39;./x.tgz&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-name-get-info-a-cacache-get-info-cache-key-promise">
<h4><a name="get-info"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">cacache.get.info(cache,</span> <span class="pre">key)</span> <span class="pre">-&gt;</span> <span class="pre">Promise</span></code><a class="headerlink" href="#a-name-get-info-a-cacache-get-info-cache-key-promise" title="Permalink to this headline">¶</a></h4>
<p>Looks up <code class="docutils literal notranslate"><span class="pre">key</span></code> in the cache index, returning information about the entry if
one exists.</p>
<div class="section" id="fields">
<h5>Fields<a class="headerlink" href="#fields" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> - Key the entry was looked up under. Matches the <code class="docutils literal notranslate"><span class="pre">key</span></code> argument.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">integrity</span></code> - <a class="reference external" href="#integrity">Subresource Integrity hash</a> for the content this entry refers to.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code> - Filesystem path where content is stored, joined with <code class="docutils literal notranslate"><span class="pre">cache</span></code> argument.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time</span></code> - Timestamp the entry was first added on.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">metadata</span></code> - User-assigned metadata associated with the entry/content.</p></li>
</ul>
</div>
<div class="section" id="id5">
<h5>Example<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">cacache</span><span class="p">.</span><span class="nx">get</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="nx">cachePath</span><span class="p">,</span> <span class="s1">&#39;my-thing&#39;</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">)</span>

<span class="c1">// Output</span>
<span class="p">{</span>
  <span class="nx">key</span><span class="o">:</span> <span class="s1">&#39;my-thing&#39;</span><span class="p">,</span>
  <span class="nx">integrity</span><span class="o">:</span> <span class="s1">&#39;sha256-MUSTVERIFY+ALL/THINGS==&#39;</span>
  <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;.testcache/content/deadbeef&#39;</span><span class="p">,</span>
  <span class="nx">time</span><span class="o">:</span> <span class="mf">12345698490</span><span class="p">,</span>
  <span class="nx">size</span><span class="o">:</span> <span class="mf">849234</span><span class="p">,</span>
  <span class="nx">metadata</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;blah&#39;</span><span class="p">,</span>
    <span class="nx">version</span><span class="o">:</span> <span class="s1">&#39;1.2.3&#39;</span><span class="p">,</span>
    <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;this was once a package but now it is my-thing&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-name-get-hascontent-a-cacache-get-hascontent-cache-integrity-promise">
<h4><a name="get-hasContent"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">cacache.get.hasContent(cache,</span> <span class="pre">integrity)</span> <span class="pre">-&gt;</span> <span class="pre">Promise</span></code><a class="headerlink" href="#a-name-get-hascontent-a-cacache-get-hascontent-cache-integrity-promise" title="Permalink to this headline">¶</a></h4>
<p>Looks up a <a class="reference external" href="#integrity">Subresource Integrity hash</a> in the cache. If content
exists for this <code class="docutils literal notranslate"><span class="pre">integrity</span></code>, it will return an object, with the specific single integrity hash
that was found in <code class="docutils literal notranslate"><span class="pre">sri</span></code> key, and the size of the found content as <code class="docutils literal notranslate"><span class="pre">size</span></code>. If no content exists for this integrity, it will return <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
<div class="section" id="id6">
<h5>Example<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">cacache</span><span class="p">.</span><span class="nx">get</span><span class="p">.</span><span class="nx">hasContent</span><span class="p">(</span><span class="nx">cachePath</span><span class="p">,</span> <span class="s1">&#39;sha256-MUSTVERIFY+ALL/THINGS==&#39;</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">)</span>

<span class="c1">// Output</span>
<span class="p">{</span>
  <span class="nx">sri</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">source</span><span class="o">:</span> <span class="s1">&#39;sha256-MUSTVERIFY+ALL/THINGS==&#39;</span><span class="p">,</span>
    <span class="nx">algorithm</span><span class="o">:</span> <span class="s1">&#39;sha256&#39;</span><span class="p">,</span>
    <span class="nx">digest</span><span class="o">:</span> <span class="s1">&#39;MUSTVERIFY+ALL/THINGS==&#39;</span><span class="p">,</span>
    <span class="nx">options</span><span class="o">:</span> <span class="p">[]</span>
  <span class="p">},</span>
  <span class="nx">size</span><span class="o">:</span> <span class="mf">9001</span>
<span class="p">}</span>

<span class="nx">cacache</span><span class="p">.</span><span class="nx">get</span><span class="p">.</span><span class="nx">hasContent</span><span class="p">(</span><span class="nx">cachePath</span><span class="p">,</span> <span class="s1">&#39;sha521-NOT+IN/CACHE==&#39;</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">)</span>

<span class="c1">// Output</span>
<span class="kc">false</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-name-put-data-a-cacache-put-cache-key-data-opts-promise">
<h4><a name="put-data"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">cacache.put(cache,</span> <span class="pre">key,</span> <span class="pre">data,</span> <span class="pre">[opts])</span> <span class="pre">-&gt;</span> <span class="pre">Promise</span></code><a class="headerlink" href="#a-name-put-data-a-cacache-put-cache-key-data-opts-promise" title="Permalink to this headline">¶</a></h4>
<p>Inserts data passed to it into the cache. The returned Promise resolves with a
digest (generated according to <a class="reference external" href="#optsalgorithms"><code class="docutils literal notranslate"><span class="pre">opts.algorithms</span></code></a>) after the
cache entry has been successfully written.</p>
<div class="section" id="id7">
<h5>Example<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">fetch</span><span class="p">(</span>
  <span class="s1">&#39;https://registry.npmjs.org/cacache/-/cacache-1.0.0.tgz&#39;</span>
<span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">cacache</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="nx">cachePath</span><span class="p">,</span> <span class="s1">&#39;registry.npmjs.org|cacache@1.0.0&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">integrity</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;integrity hash is&#39;</span><span class="p">,</span> <span class="nx">integrity</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-name-put-stream-a-cacache-put-stream-cache-key-opts-writable">
<h4><a name="put-stream"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">cacache.put.stream(cache,</span> <span class="pre">key,</span> <span class="pre">[opts])</span> <span class="pre">-&gt;</span> <span class="pre">Writable</span></code><a class="headerlink" href="#a-name-put-stream-a-cacache-put-stream-cache-key-opts-writable" title="Permalink to this headline">¶</a></h4>
<p>Returns a <a class="reference external" href="https://nodejs.org/api/stream.html#stream_writable_streams">Writable
Stream</a> that inserts
data written to it into the cache. Emits an <code class="docutils literal notranslate"><span class="pre">integrity</span></code> event with the digest of
written contents when it succeeds.</p>
<div class="section" id="id8">
<h5>Example<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">request</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span>
  <span class="s1">&#39;https://registry.npmjs.org/cacache/-/cacache-1.0.0.tgz&#39;</span>
<span class="p">).</span><span class="nx">pipe</span><span class="p">(</span>
  <span class="nx">cacache</span><span class="p">.</span><span class="nx">put</span><span class="p">.</span><span class="nx">stream</span><span class="p">(</span>
    <span class="nx">cachePath</span><span class="p">,</span> <span class="s1">&#39;registry.npmjs.org|cacache@1.0.0&#39;</span>
  <span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;integrity&#39;</span><span class="p">,</span> <span class="nx">d</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`integrity digest is </span><span class="si">${</span><span class="nx">d</span><span class="si">}</span><span class="sb">`</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-name-put-options-a-cacache-put-options">
<h4><a name="put-options"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">cacache.put</span> <span class="pre">options</span></code><a class="headerlink" href="#a-name-put-options-a-cacache-put-options" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">cacache.put</span></code> functions have a number of options in common.</p>
<div class="section" id="opts-metadata">
<h5><code class="docutils literal notranslate"><span class="pre">opts.metadata</span></code><a class="headerlink" href="#opts-metadata" title="Permalink to this headline">¶</a></h5>
<p>Arbitrary metadata to be attached to the inserted key.</p>
</div>
<div class="section" id="opts-size">
<h5><code class="docutils literal notranslate"><span class="pre">opts.size</span></code><a class="headerlink" href="#opts-size" title="Permalink to this headline">¶</a></h5>
<p>If provided, the data stream will be verified to check that enough data was
passed through. If there’s more or less data than expected, insertion will fail
with an <code class="docutils literal notranslate"><span class="pre">EBADSIZE</span></code> error.</p>
</div>
<div class="section" id="opts-integrity">
<h5><code class="docutils literal notranslate"><span class="pre">opts.integrity</span></code><a class="headerlink" href="#opts-integrity" title="Permalink to this headline">¶</a></h5>
<p>If present, the pre-calculated digest for the inserted content. If this option
if provided and does not match the post-insertion digest, insertion will fail
with an <code class="docutils literal notranslate"><span class="pre">EINTEGRITY</span></code> error.</p>
<p><code class="docutils literal notranslate"><span class="pre">algorithms</span></code> has no effect if this option is present.</p>
</div>
<div class="section" id="opts-algorithms">
<h5><code class="docutils literal notranslate"><span class="pre">opts.algorithms</span></code><a class="headerlink" href="#opts-algorithms" title="Permalink to this headline">¶</a></h5>
<p>Default: [‘sha512’]</p>
<p>Hashing algorithms to use when calculating the <a class="reference external" href="#integrity">subresource integrity
digest</a>
for inserted data. Can use any algorithm listed in <code class="docutils literal notranslate"><span class="pre">crypto.getHashes()</span></code> or
<code class="docutils literal notranslate"><span class="pre">'omakase'</span></code>/<code class="docutils literal notranslate"><span class="pre">'お任せします'</span></code> to pick a random hash algorithm on each insertion. You
may also use any anagram of <code class="docutils literal notranslate"><span class="pre">'modnar'</span></code> to use this feature.</p>
<p>Currently only supports one algorithm at a time (i.e., an array length of
exactly <code class="docutils literal notranslate"><span class="pre">1</span></code>). Has no effect if <code class="docutils literal notranslate"><span class="pre">opts.integrity</span></code> is present.</p>
</div>
<div class="section" id="opts-memoize">
<h5><code class="docutils literal notranslate"><span class="pre">opts.memoize</span></code><a class="headerlink" href="#opts-memoize" title="Permalink to this headline">¶</a></h5>
<p>Default: null</p>
<p>If provided, cacache will memoize the given cache insertion in memory, bypassing
any filesystem checks for that key or digest in future cache fetches. Nothing
will be written to the in-memory cache unless this option is explicitly truthy.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">opts.memoize</span></code> is an object or a <code class="docutils literal notranslate"><span class="pre">Map</span></code>-like (that is, an object with <code class="docutils literal notranslate"><span class="pre">get</span></code>
and <code class="docutils literal notranslate"><span class="pre">set</span></code> methods), it will be written to instead of the global memoization
cache.</p>
<p>Reading from disk data can be forced by explicitly passing <code class="docutils literal notranslate"><span class="pre">memoize:</span> <span class="pre">false</span></code> to
the reader functions, but their default will be to read from memory.</p>
</div>
</div>
<div class="section" id="a-name-rm-all-a-cacache-rm-all-cache-promise">
<h4><a name="rm-all"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">cacache.rm.all(cache)</span> <span class="pre">-&gt;</span> <span class="pre">Promise</span></code><a class="headerlink" href="#a-name-rm-all-a-cacache-rm-all-cache-promise" title="Permalink to this headline">¶</a></h4>
<p>Clears the entire cache. Mainly by blowing away the cache directory itself.</p>
<div class="section" id="id9">
<h5>Example<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">cacache</span><span class="p">.</span><span class="nx">rm</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="nx">cachePath</span><span class="p">).</span><span class="nx">then</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;THE APOCALYPSE IS UPON US 😱&#39;</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-name-rm-entry-a-cacache-rm-entry-cache-key-promise">
<h4><a name="rm-entry"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">cacache.rm.entry(cache,</span> <span class="pre">key)</span> <span class="pre">-&gt;</span> <span class="pre">Promise</span></code><a class="headerlink" href="#a-name-rm-entry-a-cacache-rm-entry-cache-key-promise" title="Permalink to this headline">¶</a></h4>
<p>Alias: <code class="docutils literal notranslate"><span class="pre">cacache.rm</span></code></p>
<p>Removes the index entry for <code class="docutils literal notranslate"><span class="pre">key</span></code>. Content will still be accessible if
requested directly by content address (<a class="reference external" href="#get-stream"><code class="docutils literal notranslate"><span class="pre">get.stream.byDigest</span></code></a>).</p>
<p>To remove the content itself (which might still be used by other entries), use
<a class="reference external" href="#rm-content"><code class="docutils literal notranslate"><span class="pre">rm.content</span></code></a>. Or, to safely vacuum any unused content, use
<a class="reference external" href="#verify"><code class="docutils literal notranslate"><span class="pre">verify</span></code></a>.</p>
<div class="section" id="id10">
<h5>Example<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">cacache</span><span class="p">.</span><span class="nx">rm</span><span class="p">.</span><span class="nx">entry</span><span class="p">(</span><span class="nx">cachePath</span><span class="p">,</span> <span class="s1">&#39;my-thing&#39;</span><span class="p">).</span><span class="nx">then</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;I did not like it anyway&#39;</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-name-rm-content-a-cacache-rm-content-cache-integrity-promise">
<h4><a name="rm-content"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">cacache.rm.content(cache,</span> <span class="pre">integrity)</span> <span class="pre">-&gt;</span> <span class="pre">Promise</span></code><a class="headerlink" href="#a-name-rm-content-a-cacache-rm-content-cache-integrity-promise" title="Permalink to this headline">¶</a></h4>
<p>Removes the content identified by <code class="docutils literal notranslate"><span class="pre">integrity</span></code>. Any index entries referring to it
will not be usable again until the content is re-added to the cache with an
identical digest.</p>
<div class="section" id="id11">
<h5>Example<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">cacache</span><span class="p">.</span><span class="nx">rm</span><span class="p">.</span><span class="nx">content</span><span class="p">(</span><span class="nx">cachePath</span><span class="p">,</span> <span class="s1">&#39;sha512-SoMeDIGest/IN+BaSE64==&#39;</span><span class="p">).</span><span class="nx">then</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;data for my-thing is gone!&#39;</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-name-set-locale-a-cacache-setlocale-locale">
<h4><a name="set-locale"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">cacache.setLocale(locale)</span></code><a class="headerlink" href="#a-name-set-locale-a-cacache-setlocale-locale" title="Permalink to this headline">¶</a></h4>
<p>Configure the language/locale used for messages and errors coming from cacache.
The list of available locales is in the <code class="docutils literal notranslate"><span class="pre">./locales</span></code> directory in the project
root.</p>
<p><em>Interested in contributing more languages! <span class="xref myst">Submit a PR</span>!</em></p>
</div>
<div class="section" id="a-name-clear-memoized-a-cacache-clearmemoized">
<h4><a name="clear-memoized"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">cacache.clearMemoized()</span></code><a class="headerlink" href="#a-name-clear-memoized-a-cacache-clearmemoized" title="Permalink to this headline">¶</a></h4>
<p>Completely resets the in-memory entry cache.</p>
</div>
<div class="section" id="a-name-tmp-mkdir-a-tmp-mkdir-cache-opts-promise-path">
<h4><a name="tmp-mkdir"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">tmp.mkdir(cache,</span> <span class="pre">opts)</span> <span class="pre">-&gt;</span> <span class="pre">Promise&lt;Path&gt;</span></code><a class="headerlink" href="#a-name-tmp-mkdir-a-tmp-mkdir-cache-opts-promise-path" title="Permalink to this headline">¶</a></h4>
<p>Returns a unique temporary directory inside the cache’s <code class="docutils literal notranslate"><span class="pre">tmp</span></code> dir. This
directory will use the same safe user assignment that all the other stuff use.</p>
<p>Once the directory is made, it’s the user’s responsibility that all files
within are given the appropriate <code class="docutils literal notranslate"><span class="pre">gid</span></code>/<code class="docutils literal notranslate"><span class="pre">uid</span></code> ownership settings to match
the rest of the cache. If not, you can ask cacache to do it for you by
calling <a class="reference external" href="#tmp-fix"><code class="docutils literal notranslate"><span class="pre">tmp.fix()</span></code></a>, which will fix all tmp directory
permissions.</p>
<p>If you want automatic cleanup of this directory, use
<a class="reference external" href="#with-tpm"><code class="docutils literal notranslate"><span class="pre">tmp.withTmp()</span></code></a></p>
<div class="section" id="id12">
<h5>Example<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span>cacache.tmp.mkdir(cache).then(dir =&gt; {
  fs.writeFile(path.join(dir, &#39;blablabla&#39;), Buffer#&lt;1234&gt;, ...)
})
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-name-tmp-fix-a-tmp-fix-cache-promise">
<h4><a name="tmp-fix"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">tmp.fix(cache)</span> <span class="pre">-&gt;</span> <span class="pre">Promise</span></code><a class="headerlink" href="#a-name-tmp-fix-a-tmp-fix-cache-promise" title="Permalink to this headline">¶</a></h4>
<p>Sets the <code class="docutils literal notranslate"><span class="pre">uid</span></code> and <code class="docutils literal notranslate"><span class="pre">gid</span></code> properties on all files and folders within the tmp
folder to match the rest of the cache.</p>
<p>Use this after manually writing files into <a class="reference external" href="#tmp-mkdir"><code class="docutils literal notranslate"><span class="pre">tmp.mkdir</span></code></a> or
<a class="reference external" href="#with-tmp"><code class="docutils literal notranslate"><span class="pre">tmp.withTmp</span></code></a>.</p>
<div class="section" id="id13">
<h5>Example<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">cacache</span><span class="p">.</span><span class="nx">tmp</span><span class="p">.</span><span class="nx">mkdir</span><span class="p">(</span><span class="nx">cache</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">dir</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">writeFile</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">dir</span><span class="p">,</span> <span class="s1">&#39;file&#39;</span><span class="p">),</span> <span class="nx">someData</span><span class="p">).</span><span class="nx">then</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="c1">// make sure we didn&#39;t just put a root-owned file in the cache</span>
    <span class="nx">cacache</span><span class="p">.</span><span class="nx">tmp</span><span class="p">.</span><span class="nx">fix</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="c1">// all uids and gids match now</span>
    <span class="p">})</span>
  <span class="p">})</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-name-with-tmp-a-tmp-withtmp-cache-opts-cb-promise">
<h4><a name="with-tmp"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">tmp.withTmp(cache,</span> <span class="pre">opts,</span> <span class="pre">cb)</span> <span class="pre">-&gt;</span> <span class="pre">Promise</span></code><a class="headerlink" href="#a-name-with-tmp-a-tmp-withtmp-cache-opts-cb-promise" title="Permalink to this headline">¶</a></h4>
<p>Creates a temporary directory with <a class="reference external" href="#tmp-mkdir"><code class="docutils literal notranslate"><span class="pre">tmp.mkdir()</span></code></a> and calls <code class="docutils literal notranslate"><span class="pre">cb</span></code>
with it. The created temporary directory will be removed when the return value
of <code class="docutils literal notranslate"><span class="pre">cb()</span></code> resolves – that is, if you return a Promise from <code class="docutils literal notranslate"><span class="pre">cb()</span></code>, the tmp
directory will be automatically deleted once that promise completes.</p>
<p>The same caveats apply when it comes to managing permissions for the tmp dir’s
contents.</p>
<div class="section" id="id14">
<h5>Example<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span>cacache.tmp.withTmp(cache, dir =&gt; {
  return fs.writeFileAsync(path.join(dir, &#39;blablabla&#39;), Buffer#&lt;1234&gt;, ...)
}).then(() =&gt; {
  // `dir` no longer exists
})
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-name-integrity-a-subresource-integrity-digests">
<h4><a name="integrity"></a> Subresource Integrity Digests<a class="headerlink" href="#a-name-integrity-a-subresource-integrity-digests" title="Permalink to this headline">¶</a></h4>
<p>For content verification and addressing, cacache uses strings following the
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity">Subresource
Integrity spec</a>.
That is, any time cacache expects an <code class="docutils literal notranslate"><span class="pre">integrity</span></code> argument or option, it
should be in the format <code class="docutils literal notranslate"><span class="pre">&lt;hashAlgorithm&gt;-&lt;base64-hash&gt;</span></code>.</p>
<p>One deviation from the current spec is that cacache will support any hash
algorithms supported by the underlying Node.js process. You can use
<code class="docutils literal notranslate"><span class="pre">crypto.getHashes()</span></code> to see which ones you can use.</p>
<div class="section" id="generating-digests-yourself">
<h5>Generating Digests Yourself<a class="headerlink" href="#generating-digests-yourself" title="Permalink to this headline">¶</a></h5>
<p>If you have an existing content shasum, they are generally formatted as a
hexadecimal string (that is, a sha1 would look like:
<code class="docutils literal notranslate"><span class="pre">5f5513f8822fdbe5145af33b64d8d970dcf95c6e</span></code>). In order to be compatible with
cacache, you’ll need to convert this to an equivalent subresource integrity
string. For this example, the corresponding hash would be:
<code class="docutils literal notranslate"><span class="pre">sha1-X1UT+IIv2+UUWvM7ZNjZcNz5XG4=</span></code>.</p>
<p>If you want to generate an integrity string yourself for existing data, you can
use something like this:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;crypto&#39;</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">hashAlgorithm</span> <span class="o">=</span> <span class="s1">&#39;sha512&#39;</span>
<span class="kr">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="s1">&#39;foobarbaz&#39;</span>

<span class="kr">const</span> <span class="nx">integrity</span> <span class="o">=</span> <span class="p">(</span>
  <span class="nx">hashAlgorithm</span> <span class="o">+</span>
  <span class="s1">&#39;-&#39;</span> <span class="o">+</span>
  <span class="nx">crypto</span><span class="p">.</span><span class="nx">createHash</span><span class="p">(</span><span class="nx">hashAlgorithm</span><span class="p">).</span><span class="nx">update</span><span class="p">(</span><span class="nx">data</span><span class="p">).</span><span class="nx">digest</span><span class="p">(</span><span class="s1">&#39;base64&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>You can also use <a class="reference external" href="https://npm.im/ssri"><code class="docutils literal notranslate"><span class="pre">ssri</span></code></a> to have a richer set of functionality
around SRI strings, including generation, parsing, and translating from existing
hex-formatted strings.</p>
</div>
</div>
<div class="section" id="a-name-verify-a-cacache-verify-cache-opts-promise">
<h4><a name="verify"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">cacache.verify(cache,</span> <span class="pre">opts)</span> <span class="pre">-&gt;</span> <span class="pre">Promise</span></code><a class="headerlink" href="#a-name-verify-a-cacache-verify-cache-opts-promise" title="Permalink to this headline">¶</a></h4>
<p>Checks out and fixes up your cache:</p>
<ul class="simple">
<li><p>Cleans up corrupted or invalid index entries.</p></li>
<li><p>Custom entry filtering options.</p></li>
<li><p>Garbage collects any content entries not referenced by the index.</p></li>
<li><p>Checks integrity for all content entries and removes invalid content.</p></li>
<li><p>Fixes cache ownership.</p></li>
<li><p>Removes the <code class="docutils literal notranslate"><span class="pre">tmp</span></code> directory in the cache and all its contents.</p></li>
</ul>
<p>When it’s done, it’ll return an object with various stats about the verification
process, including amount of storage reclaimed, number of valid entries, number
of entries removed, etc.</p>
<div class="section" id="options">
<h5>Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">opts.filter</span></code> - receives a formatted entry. Return false to remove it.
Note: might be called more than once on the same entry.</p></li>
</ul>
</div>
<div class="section" id="id15">
<h5>Example<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h5>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span> somegarbage &gt;&gt; <span class="nv">$CACHEPATH</span>/content/deadbeef
</pre></div>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">cacache</span><span class="p">.</span><span class="nx">verify</span><span class="p">(</span><span class="nx">cachePath</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">stats</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="c1">// deadbeef collected, because of invalid checksum.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;cache is much nicer now! stats:&#39;</span><span class="p">,</span> <span class="nx">stats</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-name-verify-last-run-a-cacache-verify-lastrun-cache-promise">
<h4><a name="verify-last-run"></a> <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">cacache.verify.lastRun(cache)</span> <span class="pre">-&gt;</span> <span class="pre">Promise</span></code><a class="headerlink" href="#a-name-verify-last-run-a-cacache-verify-lastrun-cache-promise" title="Permalink to this headline">¶</a></h4>
<p>Returns a <code class="docutils literal notranslate"><span class="pre">Date</span></code> representing the last time <code class="docutils literal notranslate"><span class="pre">cacache.verify</span></code> was run on <code class="docutils literal notranslate"><span class="pre">cache</span></code>.</p>
<div class="section" id="id16">
<h5>Example<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">cacache</span><span class="p">.</span><span class="nx">verify</span><span class="p">(</span><span class="nx">cachePath</span><span class="p">).</span><span class="nx">then</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">cacache</span><span class="p">.</span><span class="nx">verify</span><span class="p">.</span><span class="nx">lastRun</span><span class="p">(</span><span class="nx">cachePath</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">lastTime</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;cacache.verify was last called on&#39;</span> <span class="o">+</span> <span class="nx">lastTime</span><span class="p">)</span>
  <span class="p">})</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "AyrtonB/ESDA-Spatial",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./.cache/yarn/v6/npm-cacache-12.0.4-668bcbd105aeb5f1d92fe25570ec9525c8faa40c-integrity/node_modules/cacache"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Ayrton Bourn, Santiago De La Fuente, Clem Attwood, Joanna Kuleszo, Camilo Perico<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../../../../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>