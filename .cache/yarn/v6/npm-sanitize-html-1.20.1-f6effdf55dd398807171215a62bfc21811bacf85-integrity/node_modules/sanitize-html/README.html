
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sanitize-html &#8212; Spatial Analysis for Energy</title>
    
  <link rel="stylesheet" href="../../../../../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../../../../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../../../../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../../_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../../../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../../../../../" src="../../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../../_static/jquery.js"></script>
    <script src="../../../../../../_static/underscore.js"></script>
    <script src="../../../../../../_static/doctools.js"></script>
    <script src="../../../../../../_static/language_data.js"></script>
    <script src="../../../../../../_static/togglebutton.js"></script>
    <script src="../../../../../../_static/clipboard.min.js"></script>
    <script src="../../../../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../../../../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../../../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../../../../index.html">
  
  <img src="../../../../../../_static/logo.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Spatial Analysis for Energy</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../md/Intro.html">
   UCL Energy Systems &amp; Data Analytics - Spatial Module
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../tutorials/03-Working-with-Vector-Data.html">
   Working with Vector Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../tutorials/04-Working-with-Raster-Data.html">
   Working with Raster Data
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Extensions
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../extensions/01-Mapping-with-ggplot.html">
   Mapping with ggplot
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  About
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../md/Setup.html">
   Set-Up Instructions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../md/Jupyter-Anaconda.html">
   What is Jupyter/Anaconda?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../md/ESDA%20Course.html">
   ESDA Course
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../../../../_sources/.cache/yarn/v6/npm-sanitize-html-1.20.1-f6effdf55dd398807171215a62bfc21811bacf85-integrity/node_modules/sanitize-html/README.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#requirements">
   Requirements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-use">
   How to use
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#browser">
     Browser
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#node-recommended">
     Node (Recommended)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#i-like-your-set-but-i-want-to-add-one-more-tag-is-there-a-convenient-way-sure">
       “I like your set but I want to add one more tag. Is there a convenient way?” Sure:
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#what-are-the-default-options">
       “What are the default options?”
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#what-if-i-want-to-allow-all-tags-or-all-attributes">
       “What if I want to allow all tags or all attributes?”
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#what-if-i-don-t-want-to-allow-any-tags">
       “What if I don’t want to allow
       <em>
        any
       </em>
       tags?”
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-if-i-want-to-allow-only-specific-values-on-some-attributes">
     “What if I want to allow only specific values on some attributes?”
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wildcards-for-attributes">
     Wildcards for attributes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#htmlparser2-options">
     htmlparser2 Options
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transformations">
     Transformations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filters">
     Filters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iframe-filters">
     Iframe Filters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#allowed-css-classes">
     Allowed CSS Classes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#allowed-css-styles">
     Allowed CSS Styles
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#allowed-url-schemes">
     Allowed URL schemes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#discarding-the-entire-contents-of-a-disallowed-tag">
     Discarding the entire contents of a disallowed tag
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#about-p-unk-avenue-and-apostrophe">
   About P’unk Avenue and Apostrophe
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#changelog">
   Changelog
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#support">
   Support
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="sanitize-html">
<h1>sanitize-html<a class="headerlink" href="#sanitize-html" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://circleci.com/gh/punkave/sanitize-html/tree/master"><img alt="CircleCI" src="https://circleci.com/gh/punkave/sanitize-html/tree/master.svg?style=svg" /></a></p>
<p><a href="https://apostrophecms.org/"><img src="https://raw.github.com/punkave/sanitize-html/master/logos/logo-box-madefor.png" align="right" /></a></p>
<p><code class="docutils literal notranslate"><span class="pre">sanitize-html</span></code> provides a simple HTML sanitizer with a clear API.</p>
<p><code class="docutils literal notranslate"><span class="pre">sanitize-html</span></code> is tolerant. It is well suited for cleaning up HTML fragments such as those created by ckeditor and other rich text editors. It is especially handy for removing unwanted CSS when copying and pasting from Word.</p>
<p><code class="docutils literal notranslate"><span class="pre">sanitize-html</span></code> allows you to specify the tags you want to permit, and the permitted attributes for each of those tags.</p>
<p>If a tag is not permitted, the contents of the tag are still kept, except for <code class="docutils literal notranslate"><span class="pre">script</span></code>, <code class="docutils literal notranslate"><span class="pre">style</span></code> and <code class="docutils literal notranslate"><span class="pre">textarea</span></code> tags.</p>
<p>The syntax of poorly closed <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">img</span></code> elements is cleaned up.</p>
<p><code class="docutils literal notranslate"><span class="pre">href</span></code> attributes are validated to ensure they only contain <code class="docutils literal notranslate"><span class="pre">http</span></code>, <code class="docutils literal notranslate"><span class="pre">https</span></code>, <code class="docutils literal notranslate"><span class="pre">ftp</span></code> and <code class="docutils literal notranslate"><span class="pre">mailto</span></code> URLs. Relative URLs are also allowed. Ditto for <code class="docutils literal notranslate"><span class="pre">src</span></code> attributes.</p>
<p>Allowing particular urls as a <code class="docutils literal notranslate"><span class="pre">src</span></code> to an iframe tag by filtering hostnames is also supported.</p>
<p>HTML comments are not preserved.</p>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">sanitize-html</span></code> is intended for use with Node. That’s pretty much it. All of its npm dependencies are pure JavaScript. <code class="docutils literal notranslate"><span class="pre">sanitize-html</span></code> is built on the excellent <code class="docutils literal notranslate"><span class="pre">htmlparser2</span></code> module.</p>
</div>
<div class="section" id="how-to-use">
<h2>How to use<a class="headerlink" href="#how-to-use" title="Permalink to this headline">¶</a></h2>
<div class="section" id="browser">
<h3>Browser<a class="headerlink" href="#browser" title="Permalink to this headline">¶</a></h3>
<p><em>Think first: why do you want to use it in the browser?</em> Remember, <em>servers must never trust browsers.</em> You can’t sanitize HTML for saving on the server anywhere else but on the server.</p>
<p>But, perhaps you’d like to display sanitized HTML immediately in the browser for preview. Or ask the browser to do the sanitization work on every page load. You can if you want to!</p>
<ul class="simple">
<li><p>Clone repository</p></li>
<li><p>Run npm install and build / minify:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>npm install
npm run minify
</pre></div>
</div>
<p>You’ll find the minified and unminified versions of sanitize-html (with all its dependencies included) in the dist/ directory.</p>
<p>Use it in the browser:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span>  <span class="na">src</span><span class="o">=</span><span class="s">&quot;dist/sanitize-html.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;demo.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">html</span> <span class="o">=</span> <span class="s2">&quot;&lt;strong&gt;hello world&lt;/strong&gt;&quot;</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">sanitizeHtml</span><span class="p">(</span><span class="nx">html</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">sanitizeHtml</span><span class="p">(</span><span class="s2">&quot;&lt;img src=x onerror=alert(&#39;img&#39;) /&gt;&quot;</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">sanitizeHtml</span><span class="p">(</span><span class="s2">&quot;console.log(&#39;hello world&#39;)&quot;</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">sanitizeHtml</span><span class="p">(</span><span class="s2">&quot;&lt;script&gt;alert(&#39;hello world&#39;)&lt;/script&gt;&quot;</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="section" id="node-recommended">
<h3>Node (Recommended)<a class="headerlink" href="#node-recommended" title="Permalink to this headline">¶</a></h3>
<p>Install module from console:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>npm install sanitize-html
</pre></div>
</div>
<p>Use it in your node app:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">sanitizeHtml</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;sanitize-html&#39;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">dirty</span> <span class="o">=</span> <span class="s1">&#39;some really tacky HTML&#39;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">clean</span> <span class="o">=</span> <span class="nx">sanitizeHtml</span><span class="p">(</span><span class="nx">dirty</span><span class="p">);</span>
</pre></div>
</div>
<p>That will allow our default list of allowed tags and attributes through. It’s a nice set, but probably not quite what you want. So:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// Allow only a super restricted set of tags and attributes</span>
<span class="nx">clean</span> <span class="o">=</span> <span class="nx">sanitizeHtml</span><span class="p">(</span><span class="nx">dirty</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">allowedTags</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;em&#39;</span><span class="p">,</span> <span class="s1">&#39;strong&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span> <span class="p">],</span>
  <span class="nx">allowedAttributes</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;a&#39;</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;href&#39;</span> <span class="p">]</span>
  <span class="p">},</span>
  <span class="nx">allowedIframeHostnames</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;www.youtube.com&#39;</span><span class="p">]</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Boom!</p>
<div class="section" id="i-like-your-set-but-i-want-to-add-one-more-tag-is-there-a-convenient-way-sure">
<h4>“I like your set but I want to add one more tag. Is there a convenient way?” Sure:<a class="headerlink" href="#i-like-your-set-but-i-want-to-add-one-more-tag-is-there-a-convenient-way-sure" title="Permalink to this headline">¶</a></h4>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">clean</span> <span class="o">=</span> <span class="nx">sanitizeHtml</span><span class="p">(</span><span class="nx">dirty</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">allowedTags</span><span class="o">:</span> <span class="nx">sanitizeHtml</span><span class="p">.</span><span class="nx">defaults</span><span class="p">.</span><span class="nx">allowedTags</span><span class="p">.</span><span class="nx">concat</span><span class="p">([</span> <span class="s1">&#39;img&#39;</span> <span class="p">])</span>
<span class="p">});</span>
</pre></div>
</div>
<p>If you do not specify <code class="docutils literal notranslate"><span class="pre">allowedTags</span></code> or <code class="docutils literal notranslate"><span class="pre">allowedAttributes</span></code> our default list is applied. So if you really want an empty list, specify one.</p>
</div>
<div class="section" id="what-are-the-default-options">
<h4>“What are the default options?”<a class="headerlink" href="#what-are-the-default-options" title="Permalink to this headline">¶</a></h4>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">allowedTags</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;h3&#39;</span><span class="p">,</span> <span class="s1">&#39;h4&#39;</span><span class="p">,</span> <span class="s1">&#39;h5&#39;</span><span class="p">,</span> <span class="s1">&#39;h6&#39;</span><span class="p">,</span> <span class="s1">&#39;blockquote&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;ul&#39;</span><span class="p">,</span> <span class="s1">&#39;ol&#39;</span><span class="p">,</span>
  <span class="s1">&#39;nl&#39;</span><span class="p">,</span> <span class="s1">&#39;li&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;strong&#39;</span><span class="p">,</span> <span class="s1">&#39;em&#39;</span><span class="p">,</span> <span class="s1">&#39;strike&#39;</span><span class="p">,</span> <span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;hr&#39;</span><span class="p">,</span> <span class="s1">&#39;br&#39;</span><span class="p">,</span> <span class="s1">&#39;div&#39;</span><span class="p">,</span>
  <span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="s1">&#39;thead&#39;</span><span class="p">,</span> <span class="s1">&#39;caption&#39;</span><span class="p">,</span> <span class="s1">&#39;tbody&#39;</span><span class="p">,</span> <span class="s1">&#39;tr&#39;</span><span class="p">,</span> <span class="s1">&#39;th&#39;</span><span class="p">,</span> <span class="s1">&#39;td&#39;</span><span class="p">,</span> <span class="s1">&#39;pre&#39;</span><span class="p">,</span> <span class="s1">&#39;iframe&#39;</span> <span class="p">],</span>
<span class="nx">allowedAttributes</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">a</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;href&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span> <span class="p">],</span>
  <span class="c1">// We don&#39;t currently allow img itself by default, but this</span>
  <span class="c1">// would make sense if we did. You could add srcset here,</span>
  <span class="c1">// and if you do the URL is checked for safety</span>
  <span class="nx">img</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;src&#39;</span> <span class="p">]</span>
<span class="p">},</span>
<span class="c1">// Lots of these won&#39;t come up by default because we don&#39;t allow them</span>
<span class="nx">selfClosing</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;img&#39;</span><span class="p">,</span> <span class="s1">&#39;br&#39;</span><span class="p">,</span> <span class="s1">&#39;hr&#39;</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span> <span class="s1">&#39;basefont&#39;</span><span class="p">,</span> <span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="s1">&#39;link&#39;</span><span class="p">,</span> <span class="s1">&#39;meta&#39;</span> <span class="p">],</span>
<span class="c1">// URL schemes we permit</span>
<span class="nx">allowedSchemes</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">,</span> <span class="s1">&#39;ftp&#39;</span><span class="p">,</span> <span class="s1">&#39;mailto&#39;</span> <span class="p">],</span>
<span class="nx">allowedSchemesByTag</span><span class="o">:</span> <span class="p">{},</span>
<span class="nx">allowedSchemesAppliedToAttributes</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;href&#39;</span><span class="p">,</span> <span class="s1">&#39;src&#39;</span><span class="p">,</span> <span class="s1">&#39;cite&#39;</span> <span class="p">],</span>
<span class="nx">allowProtocolRelative</span><span class="o">:</span> <span class="kc">true</span>
</pre></div>
</div>
</div>
<div class="section" id="what-if-i-want-to-allow-all-tags-or-all-attributes">
<h4>“What if I want to allow all tags or all attributes?”<a class="headerlink" href="#what-if-i-want-to-allow-all-tags-or-all-attributes" title="Permalink to this headline">¶</a></h4>
<p>Simple! instead of leaving <code class="docutils literal notranslate"><span class="pre">allowedTags</span></code> or <code class="docutils literal notranslate"><span class="pre">allowedAttributes</span></code> out of the options, set either
one or both to <code class="docutils literal notranslate"><span class="pre">false</span></code>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">allowedTags</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
<span class="nx">allowedAttributes</span><span class="o">:</span> <span class="kc">false</span>
</pre></div>
</div>
</div>
<div class="section" id="what-if-i-don-t-want-to-allow-any-tags">
<h4>“What if I don’t want to allow <em>any</em> tags?”<a class="headerlink" href="#what-if-i-don-t-want-to-allow-any-tags" title="Permalink to this headline">¶</a></h4>
<p>Also simple!  Set <code class="docutils literal notranslate"><span class="pre">allowedTags</span></code> to <code class="docutils literal notranslate"><span class="pre">[]</span></code> and <code class="docutils literal notranslate"><span class="pre">allowedAttributes</span></code> to <code class="docutils literal notranslate"><span class="pre">{}</span></code>.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">allowedTags</span><span class="o">:</span> <span class="p">[],</span>
<span class="nx">allowedAttributes</span><span class="o">:</span> <span class="p">{}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="what-if-i-want-to-allow-only-specific-values-on-some-attributes">
<h3>“What if I want to allow only specific values on some attributes?”<a class="headerlink" href="#what-if-i-want-to-allow-only-specific-values-on-some-attributes" title="Permalink to this headline">¶</a></h3>
<p>When configuring the attribute in <code class="docutils literal notranslate"><span class="pre">allowedAttributes</span></code> simply use an object with attribute <code class="docutils literal notranslate"><span class="pre">name</span></code> and an allowed <code class="docutils literal notranslate"><span class="pre">values</span></code> array. In the following example <code class="docutils literal notranslate"><span class="pre">sandbox=&quot;allow-forms</span> <span class="pre">allow-modals</span> <span class="pre">allow-orientation-lock</span> <span class="pre">allow-pointer-lock</span> <span class="pre">allow-popups</span> <span class="pre">allow-popups-to-escape-sandbox</span> <span class="pre">allow-scripts&quot;</span></code> would become <code class="docutils literal notranslate"><span class="pre">sandbox=&quot;allow-popups</span> <span class="pre">allow-scripts&quot;</span></code>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span>        <span class="nx">allowedAttributes</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">iframe</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;sandbox&#39;</span><span class="p">,</span>
              <span class="nx">multiple</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
              <span class="nx">values</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;allow-popups&#39;</span><span class="p">,</span> <span class="s1">&#39;allow-same-origin&#39;</span><span class="p">,</span> <span class="s1">&#39;allow-scripts&#39;</span><span class="p">]</span>
            <span class="p">}</span>
          <span class="p">]</span>
</pre></div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">multiple:</span> <span class="pre">true</span></code>, several allowed values may appear in the same attribute, separated by spaces. Otherwise the attribute must exactly match one and only one of the allowed values.</p>
</div>
<div class="section" id="wildcards-for-attributes">
<h3>Wildcards for attributes<a class="headerlink" href="#wildcards-for-attributes" title="Permalink to this headline">¶</a></h3>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">*</span></code> wildcard to allow all attributes with a certain prefix:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">allowedAttributes</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">a</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;href&#39;</span><span class="p">,</span> <span class="s1">&#39;data-*&#39;</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Also you can use the <code class="docutils literal notranslate"><span class="pre">*</span></code> as name for a tag, to allow listed attributes to be valid for any tag:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">allowedAttributes</span><span class="o">:</span> <span class="p">{</span>
  <span class="s1">&#39;*&#39;</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;href&#39;</span><span class="p">,</span> <span class="s1">&#39;align&#39;</span><span class="p">,</span> <span class="s1">&#39;alt&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;bgcolor&#39;</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="htmlparser2-options">
<h3>htmlparser2 Options<a class="headerlink" href="#htmlparser2-options" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">santizeHtml</span></code> is built on <code class="docutils literal notranslate"><span class="pre">htmlparser2</span></code>. By default the only option passed down is <code class="docutils literal notranslate"><span class="pre">decodeEntities:</span> <span class="pre">true</span></code> You can set the options to pass by using the parser option.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">clean</span> <span class="o">=</span> <span class="nx">sanitizeHtml</span><span class="p">(</span><span class="nx">dirty</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">allowedTags</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span>
  <span class="nx">parser</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">lowerCaseTags</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p>See the [htmlparser2 wiki] (https://github.com/fb55/htmlparser2/wiki/Parser-options) for the full list of possible options.</p>
</div>
<div class="section" id="transformations">
<h3>Transformations<a class="headerlink" href="#transformations" title="Permalink to this headline">¶</a></h3>
<p>What if you want to add or change an attribute? What if you want to transform one tag to another? No problem, it’s simple!</p>
<p>The easiest way (will change all <code class="docutils literal notranslate"><span class="pre">ol</span></code> tags to <code class="docutils literal notranslate"><span class="pre">ul</span></code> tags):</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">clean</span> <span class="o">=</span> <span class="nx">sanitizeHtml</span><span class="p">(</span><span class="nx">dirty</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">transformTags</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;ol&#39;</span><span class="o">:</span> <span class="s1">&#39;ul&#39;</span><span class="p">,</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p>The most advanced usage:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">clean</span> <span class="o">=</span> <span class="nx">sanitizeHtml</span><span class="p">(</span><span class="nx">dirty</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">transformTags</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;ol&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">tagName</span><span class="p">,</span> <span class="nx">attribs</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// My own custom magic goes here</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">tagName</span><span class="o">:</span> <span class="s1">&#39;ul&#39;</span><span class="p">,</span>
            <span class="nx">attribs</span><span class="o">:</span> <span class="p">{</span>
                <span class="kr">class</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p>You can specify the <code class="docutils literal notranslate"><span class="pre">*</span></code> wildcard instead of a tag name to transform all tags.</p>
<p>There is also a helper method which should be enough for simple cases in which you want to change the tag and/or add some attributes:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">clean</span> <span class="o">=</span> <span class="nx">sanitizeHtml</span><span class="p">(</span><span class="nx">dirty</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">transformTags</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;ol&#39;</span><span class="o">:</span> <span class="nx">sanitizeHtml</span><span class="p">.</span><span class="nx">simpleTransform</span><span class="p">(</span><span class="s1">&#39;ul&#39;</span><span class="p">,</span> <span class="p">{</span><span class="kr">class</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">}),</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">simpleTransform</span></code> helper method has 3 parameters:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">simpleTransform</span><span class="p">(</span><span class="nx">newTag</span><span class="p">,</span> <span class="nx">newAttributes</span><span class="p">,</span> <span class="nx">shouldMerge</span><span class="p">)</span>
</pre></div>
</div>
<p>The last parameter (<code class="docutils literal notranslate"><span class="pre">shouldMerge</span></code>) is set to <code class="docutils literal notranslate"><span class="pre">true</span></code> by default. When <code class="docutils literal notranslate"><span class="pre">true</span></code>, <code class="docutils literal notranslate"><span class="pre">simpleTransform</span></code> will merge the current attributes with the new ones (<code class="docutils literal notranslate"><span class="pre">newAttributes</span></code>). When <code class="docutils literal notranslate"><span class="pre">false</span></code>, all existing attributes are discarded.</p>
<p>You can also add or modify the text contents of a tag:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">clean</span> <span class="o">=</span> <span class="nx">sanitizeHtml</span><span class="p">(</span><span class="nx">dirty</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">transformTags</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;a&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">tagName</span><span class="p">,</span> <span class="nx">attribs</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">tagName</span><span class="o">:</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span>
            <span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;Some text&#39;</span>
        <span class="p">};</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p>For example, you could transform a link element with missing anchor text:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span>&lt;a href=&quot;http://somelink.com&quot;&gt;&lt;/a&gt;
</pre></div>
</div>
<p>To a link with anchor text:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span>&lt;a href=&quot;http://somelink.com&quot;&gt;Some text&lt;/a&gt;
</pre></div>
</div>
</div>
<div class="section" id="filters">
<h3>Filters<a class="headerlink" href="#filters" title="Permalink to this headline">¶</a></h3>
<p>You can provide a filter function to remove unwanted tags. Let’s suppose we need to remove empty <code class="docutils literal notranslate"><span class="pre">a</span></code> tags like:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;page.html&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>We can do that with the following filter:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">sanitizeHtml</span><span class="p">(</span>
  <span class="s1">&#39;&lt;p&gt;This is &lt;a href=&quot;http://www.linux.org&quot;&gt;&lt;/a&gt;&lt;br/&gt;Linux&lt;/p&gt;&#39;</span><span class="p">,</span>
  <span class="p">{</span>
    <span class="nx">exclusiveFilter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">frame</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">frame</span><span class="p">.</span><span class="nx">tag</span> <span class="o">===</span> <span class="s1">&#39;a&#39;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">frame</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">frame</span></code> object supplied to the callback provides the following attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tag</span></code>: The tag name, i.e. <code class="docutils literal notranslate"><span class="pre">'img'</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">attribs</span></code>: The tag’s attributes, i.e. <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">src:</span> <span class="pre">&quot;/path/to/tux.png&quot;</span> <span class="pre">}</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">text</span></code>: The text content of the tag.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tagPosition</span></code>: The index of the tag’s position in the result string.</p></li>
</ul>
<p>You can also process all text content with a provided filter function. Let’s say we want an ellipsis instead of three dots.</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>some text...<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>We can do that with the following filter:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">sanitizeHtml</span><span class="p">(</span>
  <span class="s1">&#39;&lt;p&gt;some text...&lt;/p&gt;&#39;</span><span class="p">,</span>
  <span class="p">{</span>
    <span class="nx">textFilter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">text</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">text</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\.\.\./</span><span class="p">,</span> <span class="s1">&#39;&amp;hellip;&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Note that the text passed to the <code class="docutils literal notranslate"><span class="pre">textFilter</span></code> method is already escaped for safe display as HTML. You may add markup and use entity escape sequences in your <code class="docutils literal notranslate"><span class="pre">textFilter</span></code>.</p>
</div>
<div class="section" id="iframe-filters">
<h3>Iframe Filters<a class="headerlink" href="#iframe-filters" title="Permalink to this headline">¶</a></h3>
<p>If you would like to allow iframe tags but want to control the domains that are allowed through you can provide an array of hostnames that you would like to allow as iframe sources. This hostname is a property in the options object passed as an argument to the <code class="docutils literal notranslate"><span class="pre">sanitize-html</span></code> function.</p>
<p>This array will be checked against the html that is passed to the function and return only <code class="docutils literal notranslate"><span class="pre">src</span></code> urls that include the allowed hostnames in the object. The url in the html that is passed must be formatted correctly (valid hostname) as an embedded iframe otherwise the module will strip out the src from the iframe.</p>
<p>Make sure to pass a valid hostname along with the domain you wish to allow, i.e.:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span>  <span class="nx">allowedIframeHostnames</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;www.youtube.com&#39;</span><span class="p">,</span> <span class="s1">&#39;player.vimeo.com&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>You may also specify whether or not to allow relative URLs as iframe sources.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span>  <span class="nx">allowIframeRelativeUrls</span><span class="o">:</span> <span class="kc">true</span>
</pre></div>
</div>
<p>Note that if unspecified, relative URLs will be allowed by default if no hostname filter is provided but removed by default if a hostname filter is provided.</p>
<p><strong>Remember that the <code class="docutils literal notranslate"><span class="pre">iframe</span></code> tag must be allowed as well as the <code class="docutils literal notranslate"><span class="pre">src</span></code> attribute.</strong></p>
<p>For example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">clean</span> <span class="o">=</span> <span class="nx">sanitizeHtml</span><span class="p">(</span><span class="s1">&#39;&lt;p&gt;&lt;iframe src=&quot;https://www.youtube.com/embed/nykIhs12345&quot;&gt;&lt;/iframe&gt;&lt;p&gt;&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">allowedTags</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;em&#39;</span><span class="p">,</span> <span class="s1">&#39;strong&#39;</span><span class="p">,</span> <span class="s1">&#39;iframe&#39;</span> <span class="p">],</span>
  <span class="nx">allowedClasses</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;p&#39;</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;fancy&#39;</span><span class="p">,</span> <span class="s1">&#39;simple&#39;</span> <span class="p">],</span>
  <span class="p">},</span>
  <span class="nx">allowedAttributes</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;iframe&#39;</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;src&#39;</span><span class="p">]</span>
  <span class="p">},</span>
  <span class="nx">allowedIframeHostnames</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;www.youtube.com&#39;</span><span class="p">,</span> <span class="s1">&#39;player.vimeo.com&#39;</span><span class="p">]</span>
<span class="p">});</span>
</pre></div>
</div>
<p>will pass through as safe whereas:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">clean</span> <span class="o">=</span> <span class="nx">sanitizeHtml</span><span class="p">(</span><span class="s1">&#39;&lt;p&gt;&lt;iframe src=&quot;https://www.youtube.net/embed/nykIhs12345&quot;&gt;&lt;/iframe&gt;&lt;p&gt;&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">allowedTags</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;em&#39;</span><span class="p">,</span> <span class="s1">&#39;strong&#39;</span><span class="p">,</span> <span class="s1">&#39;iframe&#39;</span> <span class="p">],</span>
  <span class="nx">allowedClasses</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;p&#39;</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;fancy&#39;</span><span class="p">,</span> <span class="s1">&#39;simple&#39;</span> <span class="p">],</span>
  <span class="p">},</span>
  <span class="nx">allowedAttributes</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;iframe&#39;</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;src&#39;</span><span class="p">]</span>
  <span class="p">},</span>
  <span class="nx">allowedIframeHostnames</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;www.youtube.com&#39;</span><span class="p">,</span> <span class="s1">&#39;player.vimeo.com&#39;</span><span class="p">]</span>
<span class="p">});</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">clean</span> <span class="o">=</span> <span class="nx">sanitizeHtml</span><span class="p">(</span><span class="s1">&#39;&lt;p&gt;&lt;iframe src=&quot;https://www.vimeo/video/12345&quot;&gt;&lt;/iframe&gt;&lt;p&gt;&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">allowedTags</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;em&#39;</span><span class="p">,</span> <span class="s1">&#39;strong&#39;</span><span class="p">,</span> <span class="s1">&#39;iframe&#39;</span> <span class="p">],</span>
  <span class="nx">allowedClasses</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;p&#39;</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;fancy&#39;</span><span class="p">,</span> <span class="s1">&#39;simple&#39;</span> <span class="p">],</span>
  <span class="p">},</span>
  <span class="nx">allowedAttributes</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;iframe&#39;</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;src&#39;</span><span class="p">]</span>
  <span class="p">},</span>
  <span class="nx">allowedIframeHostnames</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;www.youtube.com&#39;</span><span class="p">,</span> <span class="s1">&#39;player.vimeo.com&#39;</span><span class="p">]</span>
<span class="p">});</span>
</pre></div>
</div>
<p>will return an empty iframe tag.</p>
</div>
<div class="section" id="allowed-css-classes">
<h3>Allowed CSS Classes<a class="headerlink" href="#allowed-css-classes" title="Permalink to this headline">¶</a></h3>
<p>If you wish to allow specific CSS classes on a particular element, you can do so with the <code class="docutils literal notranslate"><span class="pre">allowedClasses</span></code> option. Any other CSS classes are discarded.</p>
<p>This implies that the <code class="docutils literal notranslate"><span class="pre">class</span></code> attribute is allowed on that element.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Allow only a restricted set of CSS classes and only on the p tag</span>
<span class="nx">clean</span> <span class="o">=</span> <span class="nx">sanitizeHtml</span><span class="p">(</span><span class="nx">dirty</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">allowedTags</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;em&#39;</span><span class="p">,</span> <span class="s1">&#39;strong&#39;</span> <span class="p">],</span>
  <span class="nx">allowedClasses</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;p&#39;</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;fancy&#39;</span><span class="p">,</span> <span class="s1">&#39;simple&#39;</span> <span class="p">]</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="allowed-css-styles">
<h3>Allowed CSS Styles<a class="headerlink" href="#allowed-css-styles" title="Permalink to this headline">¶</a></h3>
<p>If you wish to allow specific CSS <em>styles</em> on a particular element, you can do that with the <code class="docutils literal notranslate"><span class="pre">allowedStyles</span></code> option. Simply declare your desired attributes as regular expression options within an array for the given attribute. Specific elements will inherit whitelisted attributes from the global (*) attribute. Any other CSS classes are discarded.</p>
<p><strong>You must also use <code class="docutils literal notranslate"><span class="pre">allowedAttributes</span></code></strong> to activate the <code class="docutils literal notranslate"><span class="pre">style</span></code> attribute for the relevant elements. Otherwise this feature will never come into play.</p>
<p><strong>When constructing regular expressions, don’t forget <code class="docutils literal notranslate"><span class="pre">^</span></code> and <code class="docutils literal notranslate"><span class="pre">$</span></code>.</strong> It’s not enough to say “the string should contain this.” It must also say “and only this.”</p>
<p><strong>URLs in inline styles are NOT filtered by any mechanism other than your regular expression.</strong></p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">clean</span> <span class="o">=</span> <span class="nx">sanitizeHtml</span><span class="p">(</span><span class="nx">dirty</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">allowedTags</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">],</span>
        <span class="nx">allowedAttributes</span><span class="o">:</span> <span class="p">{</span>
          <span class="s1">&#39;p&#39;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;style&quot;</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="nx">allowedStyles</span><span class="o">:</span> <span class="p">{</span>
          <span class="s1">&#39;*&#39;</span><span class="o">:</span> <span class="p">{</span>
            <span class="c1">// Match HEX and RGB</span>
            <span class="s1">&#39;color&#39;</span><span class="o">:</span> <span class="p">[</span><span class="sr">/^\#(0x)?[0-9a-f]+$/i</span><span class="p">,</span> <span class="sr">/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/</span><span class="p">],</span>
            <span class="s1">&#39;text-align&#39;</span><span class="o">:</span> <span class="p">[</span><span class="sr">/^left$/</span><span class="p">,</span> <span class="sr">/^right$/</span><span class="p">,</span> <span class="sr">/^center$/</span><span class="p">],</span>
            <span class="c1">// Match any number with px, em, or %</span>
            <span class="s1">&#39;font-size&#39;</span><span class="o">:</span> <span class="p">[</span><span class="sr">/^\d+(?:px|em|%)$/</span><span class="p">]</span>
          <span class="p">},</span>
          <span class="s1">&#39;p&#39;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">&#39;font-size&#39;</span><span class="o">:</span> <span class="p">[</span><span class="sr">/^\d+rem$/</span><span class="p">]</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="allowed-url-schemes">
<h3>Allowed URL schemes<a class="headerlink" href="#allowed-url-schemes" title="Permalink to this headline">¶</a></h3>
<p>By default we allow the following URL schemes in cases where <code class="docutils literal notranslate"><span class="pre">href</span></code>, <code class="docutils literal notranslate"><span class="pre">src</span></code>, etc. are allowed:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">,</span> <span class="s1">&#39;ftp&#39;</span><span class="p">,</span> <span class="s1">&#39;mailto&#39;</span> <span class="p">]</span>
</pre></div>
</div>
<p>You can override this if you want to:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">sanitizeHtml</span><span class="p">(</span>
  <span class="c1">// teeny-tiny valid transparent GIF in a data URL</span>
  <span class="s1">&#39;&lt;img src=&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==&quot; /&gt;&#39;</span><span class="p">,</span>
  <span class="p">{</span>
    <span class="nx">allowedTags</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;img&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span> <span class="p">],</span>
    <span class="nx">allowedSchemes</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;http&#39;</span> <span class="p">]</span>
  <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
<p>You can also allow a scheme for a particular tag only:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">allowedSchemes</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span> <span class="p">],</span>
<span class="nx">allowedSchemesByTag</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">img</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;data&#39;</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>And you can forbid the use of protocol-relative URLs (starting with <code class="docutils literal notranslate"><span class="pre">//</span></code>) to access another site using the current protocol, which is allowed by default:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">allowProtocolRelative</span><span class="o">:</span> <span class="kc">false</span>
</pre></div>
</div>
</div>
<div class="section" id="discarding-the-entire-contents-of-a-disallowed-tag">
<h3>Discarding the entire contents of a disallowed tag<a class="headerlink" href="#discarding-the-entire-contents-of-a-disallowed-tag" title="Permalink to this headline">¶</a></h3>
<p>Normally, with a few exceptions, if a tag is not allowed, all of the text within it is preserved, and so are any allowed tags within it.</p>
<p>The exceptions are:</p>
<p><code class="docutils literal notranslate"><span class="pre">style</span></code>, <code class="docutils literal notranslate"><span class="pre">script</span></code>, <code class="docutils literal notranslate"><span class="pre">textarea</span></code></p>
<p>If you wish to expand this list, for instance to discard whatever is found inside a <code class="docutils literal notranslate"><span class="pre">noscript</span></code> tag, use the <code class="docutils literal notranslate"><span class="pre">nonTextTags</span></code> option:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">nonTextTags</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="s1">&#39;script&#39;</span><span class="p">,</span> <span class="s1">&#39;textarea&#39;</span><span class="p">,</span> <span class="s1">&#39;noscript&#39;</span> <span class="p">]</span>
</pre></div>
</div>
<p>Note that if you use this option you are responsible for stating the entire list. This gives you the power to retain the content of <code class="docutils literal notranslate"><span class="pre">textarea</span></code>, if you want to.</p>
<p>The content still gets escaped properly, with the exception of the <code class="docutils literal notranslate"><span class="pre">script</span></code> and <code class="docutils literal notranslate"><span class="pre">style</span></code> tags. <em>Allowing either <code class="docutils literal notranslate"><span class="pre">script</span></code> or <code class="docutils literal notranslate"><span class="pre">style</span></code> leaves you open to XSS attacks. Don’t do that</em> unless you have good reason to trust their origin.</p>
</div>
</div>
<div class="section" id="about-p-unk-avenue-and-apostrophe">
<h2>About P’unk Avenue and Apostrophe<a class="headerlink" href="#about-p-unk-avenue-and-apostrophe" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">sanitize-html</span></code> was created at <a class="reference external" href="http://punkave.com">P’unk Avenue</a> for use in ApostropheCMS, an open-source content management system built on node.js. If you like <code class="docutils literal notranslate"><span class="pre">sanitize-html</span></code> you should definitely <a class="reference external" href="http://apostrophecms.org">check out apostrophecms.org</a>.</p>
</div>
<div class="section" id="changelog">
<h2>Changelog<a class="headerlink" href="#changelog" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/punkave/sanitize-html/blob/master/CHANGELOG.md">The changelog is now in a separate file for readability.</a></p>
</div>
<div class="section" id="support">
<h2>Support<a class="headerlink" href="#support" title="Permalink to this headline">¶</a></h2>
<p>Feel free to open issues on <a class="reference external" href="http://github.com/punkave/sanitize-html">github</a>.</p>
<p><a href="http://punkave.com/"><img src="https://raw.github.com/punkave/sanitize-html/master/logos/logo-box-builtby.png" /></a></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "AyrtonB/ESDA-Spatial",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./.cache/yarn/v6/npm-sanitize-html-1.20.1-f6effdf55dd398807171215a62bfc21811bacf85-integrity/node_modules/sanitize-html"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Ayrton Bourn, Santiago De La Fuente, Clem Attwood, Joanna Kuleszo, Camilo Perico<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../../../../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>