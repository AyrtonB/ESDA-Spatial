
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>How to Write Custom Syntax &#8212; Spatial Analysis for Energy</title>
    
  <link rel="stylesheet" href="../../../../../../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../../../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../../../../../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../../../../../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../../../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../../../_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../../../../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../../../../../../" src="../../../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../../../_static/jquery.js"></script>
    <script src="../../../../../../../_static/underscore.js"></script>
    <script src="../../../../../../../_static/doctools.js"></script>
    <script src="../../../../../../../_static/language_data.js"></script>
    <script src="../../../../../../../_static/togglebutton.js"></script>
    <script src="../../../../../../../_static/clipboard.min.js"></script>
    <script src="../../../../../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../../../../../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../../../../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../../../../../index.html">
  
  <img src="../../../../../../../_static/logo.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Spatial Analysis for Energy</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../../../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../../md/Intro.html">
   UCL Energy Systems &amp; Data Analytics - Spatial Module
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../../tutorials/03-Working-with-Vector-Data.html">
   Working with Vector Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../../tutorials/04-Working-with-Raster-Data.html">
   Working with Raster Data
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Extensions
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../../extensions/01-Mapping-with-ggplot.html">
   Mapping with ggplot
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  About
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../../md/Setup.html">
   Set-Up Instructions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../../md/Jupyter-Anaconda.html">
   What is Jupyter/Anaconda?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../../md/ESDA%20Course.html">
   ESDA Course
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../../../../../_sources/.cache/yarn/v6/npm-postcss-7.0.32-4310d6ee347053da3433db2be492883d62cec59d-integrity/node_modules/postcss/docs/syntax.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#syntax">
   Syntax
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parser">
   Parser
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#main-theory">
     Main Theory
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#performance">
     Performance
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#node-source">
     Node Source
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#raw-values">
     Raw Values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tests">
     Tests
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stringifier">
   Stringifier
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Main Theory
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#builder-function">
     Builder Function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Raw Values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Tests
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="how-to-write-custom-syntax">
<h1>How to Write Custom Syntax<a class="headerlink" href="#how-to-write-custom-syntax" title="Permalink to this headline">¶</a></h1>
<p>PostCSS can transform styles in any syntax, and is not limited to just CSS.
By writing a custom syntax, you can transform styles in any desired format.</p>
<p>Writing a custom syntax is much harder than writing a PostCSS plugin, but
it is an awesome adventure.</p>
<p>There are 3 types of PostCSS syntax packages:</p>
<ul class="simple">
<li><p><strong>Parser</strong> to parse input string to node’s tree.</p></li>
<li><p><strong>Stringifier</strong> to generate output string by node’s tree.</p></li>
<li><p><strong>Syntax</strong> contains both parser and stringifier.</p></li>
</ul>
<div class="section" id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<p>A good example of a custom syntax is <a class="reference external" href="https://github.com/postcss/postcss-scss">SCSS</a>. Some users may want to transform
SCSS sources with PostCSS plugins, for example if they need to add vendor
prefixes or change the property order. So this syntax should output SCSS from
an SCSS input.</p>
<p>The syntax API is a very simple plain object, with <code class="docutils literal notranslate"><span class="pre">parse</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">stringify</span></code>
functions:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">parse</span><span class="o">:</span>     <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./parse&#39;</span><span class="p">),</span>
  <span class="nx">stringify</span><span class="o">:</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./stringify&#39;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="parser">
<h2>Parser<a class="headerlink" href="#parser" title="Permalink to this headline">¶</a></h2>
<p>A good example of a parser is <a class="reference external" href="https://github.com/postcss/postcss-safe-parser">Safe Parser</a>, which parses malformed/broken CSS.
Because there is no point to generate broken output, this package only provides
a parser.</p>
<p>The parser API is a function which receives a string &amp; returns a <a class="reference external" href="http://api.postcss.org/Root.html"><code class="docutils literal notranslate"><span class="pre">Root</span></code></a> node.
The second argument is a function which receives an object with PostCSS options.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">postcss</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;postcss&#39;</span><span class="p">)</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">parse</span> <span class="p">(</span><span class="nx">css</span><span class="p">,</span> <span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">root</span> <span class="o">=</span> <span class="nx">postcss</span><span class="p">.</span><span class="nx">root</span><span class="p">()</span>
  <span class="c1">// Add other nodes to root</span>
  <span class="k">return</span> <span class="nx">root</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="main-theory">
<h3>Main Theory<a class="headerlink" href="#main-theory" title="Permalink to this headline">¶</a></h3>
<p>There are many books about parsers; but do not worry because CSS syntax is
very easy, and so the parser will be much simpler than a programming language
parser.</p>
<p>The default PostCSS parser contains two steps:</p>
<ol class="simple">
<li><p><a class="reference external" href="https://github.com/postcss/postcss/blob/master/lib/tokenize.es6">Tokenizer</a> which reads input string character by character and builds a
tokens array. For example, it joins space symbols to a <code class="docutils literal notranslate"><span class="pre">['space',</span> <span class="pre">'\n</span>&#160; <span class="pre">']</span></code>
token, and detects strings to a <code class="docutils literal notranslate"><span class="pre">['string',</span> <span class="pre">'&quot;\&quot;{&quot;']</span></code> token.</p></li>
<li><p><a class="reference external" href="https://github.com/postcss/postcss/blob/master/lib/parser.es6">Parser</a> which reads the tokens array, creates node instances and
builds a tree.</p></li>
</ol>
</div>
<div class="section" id="performance">
<h3>Performance<a class="headerlink" href="#performance" title="Permalink to this headline">¶</a></h3>
<p>Parsing input is often the most time consuming task in CSS processors. So it
is very important to have a fast parser.</p>
<p>The main rule of optimization is that there is no performance without a
benchmark. You can look at <a class="reference external" href="https://github.com/postcss/benchmark">PostCSS benchmarks</a> to build your own.</p>
<p>Of parsing tasks, the tokenize step will often take the most time, so its
performance should be prioritized. Unfortunately, classes, functions and
high level structures can slow down your tokenizer. Be ready to write dirty
code with repeated statements. This is why it is difficult to extend the
default <a class="reference external" href="https://github.com/postcss/postcss/blob/master/lib/tokenize.es6">PostCSS tokenizer</a>; copy &amp; paste will be a necessary evil.</p>
<p>Second optimization is using character codes instead of strings.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// Slow</span>
<span class="nx">string</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;{&#39;</span>

<span class="c1">// Fast</span>
<span class="kr">const</span> <span class="nx">OPEN_CURLY</span> <span class="o">=</span> <span class="mf">123</span> <span class="c1">// `{&#39;</span>
<span class="nx">string</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">===</span> <span class="nx">OPEN_CURLY</span>
</pre></div>
</div>
<p>Third optimization is “fast jumps”. If you find open quotes, you can find
next closing quote much faster by <code class="docutils literal notranslate"><span class="pre">indexOf</span></code>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// Simple jump</span>
<span class="nx">next</span> <span class="o">=</span> <span class="nx">string</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="nx">currentPosition</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span>

<span class="c1">// Jump by RegExp</span>
<span class="nx">regexp</span><span class="p">.</span><span class="nx">lastIndex</span> <span class="o">=</span> <span class="nx">currentPosion</span> <span class="o">+</span> <span class="mf">1</span>
<span class="nx">regexp</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span>
<span class="nx">next</span> <span class="o">=</span> <span class="nx">regexp</span><span class="p">.</span><span class="nx">lastIndex</span>
</pre></div>
</div>
<p>The parser can be a well written class. There is no need in copy-paste and
hardcore optimization there. You can extend the default <a class="reference external" href="https://github.com/postcss/postcss/blob/master/lib/parser.es6">PostCSS parser</a>.</p>
</div>
<div class="section" id="node-source">
<h3>Node Source<a class="headerlink" href="#node-source" title="Permalink to this headline">¶</a></h3>
<p>Every node should have <code class="docutils literal notranslate"><span class="pre">source</span></code> property to generate correct source map.
This property contains <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">end</span></code> properties with <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">line,</span> <span class="pre">column</span> <span class="pre">}</span></code>,
and <code class="docutils literal notranslate"><span class="pre">input</span></code> property with an <a class="reference external" href="https://github.com/postcss/postcss/blob/master/lib/input.es6"><code class="docutils literal notranslate"><span class="pre">Input</span></code></a> instance.</p>
<p>Your tokenizer should save the original position so that you can propagate
the values to the parser, to ensure that the source map is correctly updated.</p>
</div>
<div class="section" id="raw-values">
<h3>Raw Values<a class="headerlink" href="#raw-values" title="Permalink to this headline">¶</a></h3>
<p>A good PostCSS parser should provide all information (including spaces symbols)
to generate byte-to-byte equal output. It is not so difficult, but respectful
for user input and allow integration smoke tests.</p>
<p>A parser should save all additional symbols to <code class="docutils literal notranslate"><span class="pre">node.raws</span></code> object.
It is an open structure for you, you can add additional keys.
For example, <a class="reference external" href="https://github.com/postcss/postcss-scss">SCSS parser</a> saves comment types (<code class="docutils literal notranslate"><span class="pre">/*</span> <span class="pre">*/</span></code> or <code class="docutils literal notranslate"><span class="pre">//</span></code>)
in <code class="docutils literal notranslate"><span class="pre">node.raws.inline</span></code>.</p>
<p>The default parser cleans CSS values from comments and spaces.
It saves the original value with comments to <code class="docutils literal notranslate"><span class="pre">node.raws.value.raw</span></code> and uses it,
if the node value was not changed.</p>
</div>
<div class="section" id="tests">
<h3>Tests<a class="headerlink" href="#tests" title="Permalink to this headline">¶</a></h3>
<p>Of course, all parsers in the PostCSS ecosystem must have tests.</p>
<p>If your parser just extends CSS syntax (like <a class="reference external" href="https://github.com/postcss/postcss-scss">SCSS</a> or <a class="reference external" href="https://github.com/postcss/postcss-safe-parser">Safe Parser</a>),
you can use the <a class="reference external" href="https://github.com/postcss/postcss-parser-tests">PostCSS Parser Tests</a>. It contains unit &amp; integration tests.</p>
</div>
</div>
<div class="section" id="stringifier">
<h2>Stringifier<a class="headerlink" href="#stringifier" title="Permalink to this headline">¶</a></h2>
<p>A style guide generator is a good example of a stringifier. It generates output
HTML which contains CSS components. For this use case, a parser isn’t necessary,
so the package should just contain a stringifier.</p>
<p>The Stringifier API is little bit more complicated, than the parser API.
PostCSS generates a source map, so a stringifier can’t just return a string.
It must link every substring with its source node.</p>
<p>A Stringifier is a function which receives <a class="reference external" href="http://api.postcss.org/Root.html"><code class="docutils literal notranslate"><span class="pre">Root</span></code></a> node and builder callback.
Then it calls builder with every node’s string and node instance.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">stringify</span> <span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="nx">builder</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Some magic</span>
  <span class="kr">const</span> <span class="nx">string</span> <span class="o">=</span> <span class="nx">decl</span><span class="p">.</span><span class="nx">prop</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nx">decl</span><span class="p">.</span><span class="nx">value</span> <span class="o">+</span> <span class="s1">&#39;;&#39;</span>
  <span class="nx">builder</span><span class="p">(</span><span class="nx">string</span><span class="p">,</span> <span class="nx">decl</span><span class="p">)</span>
  <span class="c1">// Some science</span>
<span class="p">};</span>
</pre></div>
</div>
<div class="section" id="id1">
<h3>Main Theory<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>PostCSS <a class="reference external" href="https://github.com/postcss/postcss/blob/master/lib/stringifier.es6">default stringifier</a> is just a class with a method for each node type
and many methods to detect raw properties.</p>
<p>In most cases it will be enough just to extend this class,
like in <a class="reference external" href="https://github.com/postcss/postcss-scss/blob/master/lib/scss-stringifier.es6">SCSS stringifier</a>.</p>
</div>
<div class="section" id="builder-function">
<h3>Builder Function<a class="headerlink" href="#builder-function" title="Permalink to this headline">¶</a></h3>
<p>A builder function will be passed to <code class="docutils literal notranslate"><span class="pre">stringify</span></code> function as second argument.
For example, the default PostCSS stringifier class saves it
to <code class="docutils literal notranslate"><span class="pre">this.builder</span></code> property.</p>
<p>Builder receives output substring and source node to append this substring
to the final output.</p>
<p>Some nodes contain other nodes in the middle. For example, a rule has a <code class="docutils literal notranslate"><span class="pre">{</span></code>
at the beginning, many declarations inside and a closing <code class="docutils literal notranslate"><span class="pre">}</span></code>.</p>
<p>For these cases, you should pass a third argument to builder function:
<code class="docutils literal notranslate"><span class="pre">'start'</span></code> or <code class="docutils literal notranslate"><span class="pre">'end'</span></code> string:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="k">this</span><span class="p">.</span><span class="nx">builder</span><span class="p">(</span><span class="nx">rule</span><span class="p">.</span><span class="nx">selector</span> <span class="o">+</span> <span class="s1">&#39;{&#39;</span><span class="p">,</span> <span class="nx">rule</span><span class="p">,</span> <span class="s1">&#39;start&#39;</span><span class="p">)</span>
<span class="c1">// Stringify declarations inside</span>
<span class="k">this</span><span class="p">.</span><span class="nx">builder</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">,</span> <span class="nx">rule</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3>Raw Values<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>A good PostCSS custom syntax saves all symbols and provide byte-to-byte equal
output if there were no changes.</p>
<p>This is why every node has <code class="docutils literal notranslate"><span class="pre">node.raws</span></code> object to store space symbol, etc.</p>
<p>All data related to source code and not CSS structure, should be in <code class="docutils literal notranslate"><span class="pre">Node#raws</span></code>. For instance, <code class="docutils literal notranslate"><span class="pre">postcss-scss</span></code> keep in <code class="docutils literal notranslate"><span class="pre">Comment#raws.inline</span></code> boolean marker of inline comment (<code class="docutils literal notranslate"><span class="pre">//</span> <span class="pre">comment</span></code> instead of <code class="docutils literal notranslate"><span class="pre">/*</span> <span class="pre">comment</span> <span class="pre">*/</span></code>).</p>
<p>Be careful, because sometimes these raw properties will not be present; some
nodes may be built manually, or may lose their indentation when they are moved
to another parent node.</p>
<p>This is why the default stringifier has a <code class="docutils literal notranslate"><span class="pre">raw()</span></code> method to autodetect raw
properties by other nodes. For example, it will look at other nodes to detect
indent size and them multiply it with the current node depth.</p>
</div>
<div class="section" id="id3">
<h3>Tests<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>A stringifier must have tests too.</p>
<p>You can use unit and integration test cases from <a class="reference external" href="https://github.com/postcss/postcss-parser-tests">PostCSS Parser Tests</a>.
Just compare input CSS with CSS after your parser and stringifier.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "AyrtonB/ESDA-Spatial",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./.cache/yarn/v6/npm-postcss-7.0.32-4310d6ee347053da3433db2be492883d62cec59d-integrity/node_modules/postcss/docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Ayrton Bourn, Santiago De La Fuente, Clem Attwood, Joanna Kuleszo, Camilo Perico<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../../../../../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>